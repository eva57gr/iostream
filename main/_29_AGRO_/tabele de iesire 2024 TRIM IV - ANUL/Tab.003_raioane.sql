SELECT
  :pPERIOADA AS PERIOADA,
  :pFORM AS FORM,
  :pFORM_VERS AS FORM_VERS,
  :pID_MDTABLE AS ID_MDTABLE,
  :pCOD_CUATM AS COD_CUATM,
         
  '0' AS NR_SECTIE,
  '0'AS NUME_SECTIE,
  '0' AS NR_SECTIE1,
  '0' AS NUME_SECTIE1,
  '0' AS NR_SECTIE2,
  '0' AS NUME_SECTIE2,
  ROUND(NVAL(R1110_C1)+NVAL(R1120_C1) + NVAL(R1130_C1) + NVAL(R1130_C1),0)||'~'||ORDINE AS NR_ROW,
  ORDINE,
  '00011000' AS DECIMAL_POS,
  ORDINE||' - '||DENUMIRE AS NUME_ROW,
  ROUND(NVAL(R1110_C2)+NVAL(R1120_C2) + NVAL(R1130_C2) + NVAL(R1140_C2),0) AS COL1,
  ROUND(NVAL(R1110_C3)+NVAL(R1120_C3) + NVAL(R1130_C3) + NVAL(R1140_C3),0) AS COL2,
  ROUND(NVAL(R1110_C4)+NVAL(R1120_C4) + NVAL(R1130_C4) + NVAL(R1140_C4),0) AS COL3,
  
  ROUND(NVAL(R1110_C3)+NVAL(R1120_C3) + NVAL(R1130_C3) + NVAL(R1140_C3) / 
  NOZERO(NVAL(R1110_C2)+NVAL(R1120_C2) + NVAL(R1130_C2) + NVAL(R1140_C2)),1) AS COL4,
  
  ROUND(NVAL(R1110_C4)+NVAL(R1120_C4) + NVAL(R1130_C4) + NVAL(R1140_C4) / 
  NOZERO(NVAL(R1110_C2)+NVAL(R1120_C2) + NVAL(R1130_C2) + NVAL(R1140_C2)),1) AS COL5,
  
  ROUND(NVAL(R1110_C5)+NVAL(R1120_C5) + NVAL(R1130_C5) + NVAL(R1134_C5),0) AS COL6,
  
  ROUND(NVAL(R1110_C5)+NVAL(R1120_C5) + NVAL(R1130_C5) + NVAL(R1130_C5),0) + 
  ROUND(NVAL(R1110_C3)+NVAL(R1120_C3) + NVAL(R1130_C3) + NVAL(R1130_C3),0)  AS COL7,
  
   
    ROUND(NVAL(R1110_C5)+NVAL(R1120_C5) + NVAL(R1130_C5) + NVAL(R1130_C5),0) + 
  ROUND(NVAL(R1110_C4)+NVAL(R1120_C4) + NVAL(R1130_C4) + NVAL(R1130_C4),0)  AS COL8
  

FROM
(
SELECT
  R.DENUMIRE,
  TO_NUMBER(R.CUIIO) AS ORDINE,
  
  NVAL(SUM(CASE WHEN  D.RIND IN ('1110') THEN D.COL1 END)) AS R1110_C1,
  NVAL(SUM(CASE WHEN  D.RIND IN ('1120') THEN D.COL1 END)) AS R1120_C1,
  NVAL(SUM(CASE WHEN  D.RIND IN ('1130') THEN D.COL1 END)) AS R1130_C1,
  NVAL(SUM(CASE WHEN  D.RIND IN ('1140') THEN D.COL1 END)) AS R1140_C1,
  
  NVAL(SUM(CASE WHEN  D.RIND IN ('1110') THEN D.COL2 END)) AS R1110_C2,
  NVAL(SUM(CASE WHEN  D.RIND IN ('1120') THEN D.COL2 END)) AS R1120_C2,
  NVAL(SUM(CASE WHEN  D.RIND IN ('1130') THEN D.COL2 END)) AS R1130_C2,
  NVAL(SUM(CASE WHEN  D.RIND IN ('1140') THEN D.COL2 END)) AS R1140_C2,
  
  NVAL(SUM(CASE WHEN  D.RIND IN ('1110') THEN D.COL3 END)) AS R1110_C3,
  NVAL(SUM(CASE WHEN  D.RIND IN ('1120') THEN D.COL3 END)) AS R1120_C3,
  NVAL(SUM(CASE WHEN  D.RIND IN ('1130') THEN D.COL3 END)) AS R1130_C3,
  NVAL(SUM(CASE WHEN  D.RIND IN ('1140') THEN D.COL3 END)) AS R1140_C3,
  
  NVAL(SUM(CASE WHEN  D.RIND IN ('1110') THEN D.COL4 END)) AS R1110_C4,
  NVAL(SUM(CASE WHEN  D.RIND IN ('1120') THEN D.COL4 END)) AS R1120_C4,
  NVAL(SUM(CASE WHEN  D.RIND IN ('1130') THEN D.COL4 END)) AS R1130_C4,
  NVAL(SUM(CASE WHEN  D.RIND IN ('1140') THEN D.COL4 END)) AS R1140_C4,
  
  NVAL(SUM(CASE WHEN  D.RIND IN ('1110') THEN D.COL5 END)) AS R1110_C5,
  NVAL(SUM(CASE WHEN  D.RIND IN ('1120') THEN D.COL5 END)) AS R1120_C5,
  NVAL(SUM(CASE WHEN  D.RIND IN ('1130') THEN D.COL5 END)) AS R1130_C5,
  NVAL(SUM(CASE WHEN  D.RIND IN ('1140') THEN D.COL5 END)) AS R1140_C5
  
  
  
FROM 
  VW_DATA_ALL D
  INNER JOIN RENIM R ON (D.CUIIO=R.CUIIO AND D.CUIIO_VERS=R.CUIIO_VERS)
WHERE
  D.PERIOADA IN (:pPERIOADA) AND 
  D.FORM_VERS = :pFORM_VERS     AND    
  (:pID_MDTABLE=:pID_MDTABLE) AND
  D.CUATM_FULL LIKE '%'||:pCOD_CUATM||';%' AND

  D.FORM IN (45)AND   
  D.CAPITOL IN (399) AND
   D.RIND IN ('1110','1120','1130','1140')
GROUP BY
  R.DENUMIRE,
  R.CUIIO
UNION

SELECT
  'TOTAL' AS DENUMIRE,
  0 AS ORDINE,
  
  NVAL(SUM(CASE WHEN  D.RIND IN ('1110') THEN D.COL1 END)) AS R1110_C1,
  NVAL(SUM(CASE WHEN  D.RIND IN ('1120') THEN D.COL1 END)) AS R1120_C1,
  NVAL(SUM(CASE WHEN  D.RIND IN ('1130') THEN D.COL1 END)) AS R1130_C1,
  NVAL(SUM(CASE WHEN  D.RIND IN ('1140') THEN D.COL1 END)) AS R1140_C1,
  
  NVAL(SUM(CASE WHEN  D.RIND IN ('1110') THEN D.COL2 END)) AS R1110_C2,
  NVAL(SUM(CASE WHEN  D.RIND IN ('1120') THEN D.COL2 END)) AS R1120_C2,
  NVAL(SUM(CASE WHEN  D.RIND IN ('1130') THEN D.COL2 END)) AS R1130_C2,
  NVAL(SUM(CASE WHEN  D.RIND IN ('1140') THEN D.COL2 END)) AS R1140_C2,
  
  NVAL(SUM(CASE WHEN  D.RIND IN ('1110') THEN D.COL3 END)) AS R1110_C3,
  NVAL(SUM(CASE WHEN  D.RIND IN ('1120') THEN D.COL3 END)) AS R1120_C3,
  NVAL(SUM(CASE WHEN  D.RIND IN ('1130') THEN D.COL3 END)) AS R1130_C3,
  NVAL(SUM(CASE WHEN  D.RIND IN ('1140') THEN D.COL3 END)) AS R1140_C3,
  
  NVAL(SUM(CASE WHEN  D.RIND IN ('1110') THEN D.COL4 END)) AS R1110_C4,
  NVAL(SUM(CASE WHEN  D.RIND IN ('1120') THEN D.COL4 END)) AS R1120_C4,
  NVAL(SUM(CASE WHEN  D.RIND IN ('1130') THEN D.COL4 END)) AS R1130_C4,
  NVAL(SUM(CASE WHEN  D.RIND IN ('1140') THEN D.COL4 END)) AS R1140_C4,
  
  NVAL(SUM(CASE WHEN  D.RIND IN ('1110') THEN D.COL5 END)) AS R1110_C5,
  NVAL(SUM(CASE WHEN  D.RIND IN ('1120') THEN D.COL5 END)) AS R1120_C5,
  NVAL(SUM(CASE WHEN  D.RIND IN ('1130') THEN D.COL5 END)) AS R1130_C5,
  NVAL(SUM(CASE WHEN  D.RIND IN ('1140') THEN D.COL5 END)) AS R1140_C5
FROM 
  VW_DATA_ALL D
  INNER JOIN RENIM R ON (D.CUIIO=R.CUIIO AND D.CUIIO_VERS=R.CUIIO_VERS)
WHERE
  D.PERIOADA IN (:pPERIOADA) AND 
  D.FORM_VERS = :pFORM_VERS     AND    
  (:pID_MDTABLE=:pID_MDTABLE) AND
  D.CUATM_FULL LIKE '%'||:pCOD_CUATM||';%' AND

  D.FORM IN (45)AND   
  D.CAPITOL IN (399) AND
   D.RIND IN ('1110','1120','1130','1140')
);