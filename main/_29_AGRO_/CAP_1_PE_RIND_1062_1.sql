SELECT
    D.CUIIO,
    D.CUATM,
    R.DENUMIRE,
    C.FULL_CODE,

    -- RIND 1104
    NULLIF(SUM(CASE WHEN D.RIND = '1104' THEN D.COL1 ELSE 0 END), 0) AS R_1104_C1,
    NULLIF(SUM(CASE WHEN D.RIND = '1104' THEN D.COL2 ELSE 0 END), 0) AS R_1104_C2,
    NULLIF(SUM(CASE WHEN D.RIND = '1104' THEN D.COL3 ELSE 0 END), 0) AS R_1104_C3,
    NULLIF(SUM(CASE WHEN D.RIND = '1104' THEN D.COL4 ELSE 0 END), 0) AS R_1104_C4,
    NULLIF(SUM(CASE WHEN D.RIND = '1104' THEN D.COL5 ELSE 0 END), 0) AS R_1104_C5,

    -- RIND 1110
    NULLIF(SUM(CASE WHEN D.RIND = '1110' THEN D.COL1 ELSE 0 END), 0) AS R_1110_C1,
    NULLIF(SUM(CASE WHEN D.RIND = '1110' THEN D.COL2 ELSE 0 END), 0) AS R_1110_C2,
    NULLIF(SUM(CASE WHEN D.RIND = '1110' THEN D.COL3 ELSE 0 END), 0) AS R_1110_C3,
    NULLIF(SUM(CASE WHEN D.RIND = '1110' THEN D.COL4 ELSE 0 END), 0) AS R_1110_C4,
    NULLIF(SUM(CASE WHEN D.RIND = '1110' THEN D.COL5 ELSE 0 END), 0) AS R_1110_C5,

    -- RIND 1117
    NULLIF(SUM(CASE WHEN D.RIND = '1117' THEN D.COL1 ELSE 0 END), 0) AS R_1117_C1,
    NULLIF(SUM(CASE WHEN D.RIND = '1117' THEN D.COL2 ELSE 0 END), 0) AS R_1117_C2,
    NULLIF(SUM(CASE WHEN D.RIND = '1117' THEN D.COL3 ELSE 0 END), 0) AS R_1117_C3,
    NULLIF(SUM(CASE WHEN D.RIND = '1117' THEN D.COL4 ELSE 0 END), 0) AS R_1117_C4,
    NULLIF(SUM(CASE WHEN D.RIND = '1117' THEN D.COL5 ELSE 0 END), 0) AS R_1117_C5,

    -- RIND 1218
    NULLIF(SUM(CASE WHEN D.RIND = '1218' THEN D.COL1 ELSE 0 END), 0) AS R_1218_C1,
    NULLIF(SUM(CASE WHEN D.RIND = '1218' THEN D.COL2 ELSE 0 END), 0) AS R_1218_C2,
    NULLIF(SUM(CASE WHEN D.RIND = '1218' THEN D.COL3 ELSE 0 END), 0) AS R_1218_C3,
    NULLIF(SUM(CASE WHEN D.RIND = '1218' THEN D.COL4 ELSE 0 END), 0) AS R_1218_C4,
    NULLIF(SUM(CASE WHEN D.RIND = '1218' THEN D.COL5 ELSE 0 END), 0) AS R_1218_C5,

    -- RIND 1631
    NULLIF(SUM(CASE WHEN D.RIND = '1631' THEN D.COL1 ELSE 0 END), 0) AS R_1631_C1,
    NULLIF(SUM(CASE WHEN D.RIND = '1631' THEN D.COL2 ELSE 0 END), 0) AS R_1631_C2,
    NULLIF(SUM(CASE WHEN D.RIND = '1631' THEN D.COL3 ELSE 0 END), 0) AS R_1631_C3,
    NULLIF(SUM(CASE WHEN D.RIND = '1631' THEN D.COL4 ELSE 0 END), 0) AS R_1631_C4,
    NULLIF(SUM(CASE WHEN D.RIND = '1631' THEN D.COL5 ELSE 0 END), 0) AS R_1631_C5

FROM CIS2.VW_DATA_ALL D
INNER JOIN CIS2.RENIM R ON R.CUIIO = D.CUIIO AND R.CUIIO_VERS = D.CUIIO_VERS
INNER JOIN CIS2.VW_CL_CUATM C ON C.CODUL = D.CUATM
WHERE 
    D.PERIOADA IN (1060)
    AND D.FORM IN (45)
    AND D.CAPITOL = 399
    AND D.RIND IN ('1104','1110','1117','1218','1631')
GROUP BY
    D.CUIIO,
    D.CUATM,
    R.DENUMIRE,
    C.FULL_CODE

UNION ALL

SELECT
    NULL AS CUIIO,
    CODUL AS CUATM,
    DENUMIRE,
    FULL_CODE,

    -- Coloane goale (NULL) pentru toate cele 25 coloane din SELECT-ul de mai sus
    NULL AS R_1104_C1, NULL AS R_1104_C2, NULL AS R_1104_C3, NULL AS R_1104_C4, NULL AS R_1104_C5,
    NULL AS R_1110_C1, NULL AS R_1110_C2, NULL AS R_1110_C3, NULL AS R_1110_C4, NULL AS R_1110_C5,
    NULL AS R_1117_C1, NULL AS R_1117_C2, NULL AS R_1117_C3, NULL AS R_1117_C4, NULL AS R_1117_C5,
    NULL AS R_1218_C1, NULL AS R_1218_C2, NULL AS R_1218_C3, NULL AS R_1218_C4, NULL AS R_1218_C5,
    NULL AS R_1631_C1, NULL AS R_1631_C2, NULL AS R_1631_C3, NULL AS R_1631_C4, NULL AS R_1631_C5

FROM CIS2.VW_CL_CUATM
WHERE 
    PRGS IN ('2','3','4')
    AND CODUL NOT IN ('0000000')

ORDER BY
    FULL_CODE,
    CUIIO DESC;
