SELECT
D.RIND,
D.RIND_VERS,
D.ORDINE
FROM
(
SELECT 
D.RIND,
D.RIND_VERS,
D.ORDINE
FROM CIS2.MD_RIND D
INNER JOIN 
(
SELECT 
RIND,
MAX(RIND_VERS) RIND_VERS,
MAX(ORDINE) ORDINE 
FROM CIS2.MD_RIND
   WHERE
    FORM = 45
    AND 
    capitol IN (399)
    GROUP BY
    RIND 
    
    ) 
      DD ON D.RIND=DD.RIND AND D.RIND_VERS=DD.RIND_VERS AND D.ORDINE = DD.ORDINE



WHERE 
D.STATUT = '1'
 AND    
 (D.RIND BETWEEN '1103' AND  '1115'
 OR D.RIND BETWEEN '1116' AND  '1213'
 OR D.RIND BETWEEN '1216' AND  '1219'
 OR D.RIND IN ('1221')
 OR D.RIND BETWEEN '1224' AND  '1225' 
 OR D.RIND BETWEEN '1230' AND  '1239'
 OR D.RIND IN ('1243')
 OR D.RIND IN ('1244')
 OR D.RIND BETWEEN '1301' AND  '1327'
 OR D.RIND IN ('1328')
 OR D.RIND BETWEEN '1401' AND  '1406'
 OR D.RIND IN ('1411','1418','1434','1440')
 OR D.RIND IN ('1412','1413','1419','1420')
 OR D.RIND IN ('1630','1631')
) 



UNION 

SELECT 
D.RIND,
D.RIND_VERS,
D.ORDINE + 110 ORDINE
FROM CIS2.MD_RIND D

INNER JOIN 
(
SELECT 
RIND,
MAX(RIND_VERS) RIND_VERS,
MAX(ORDINE) ORDINE 
FROM CIS2.MD_RIND
   WHERE
    FORM = 45
    AND 
    capitol IN (401)
    GROUP BY
    RIND 
   -- ORDINE
    ) DD ON D.RIND=DD.RIND AND D.RIND_VERS=DD.RIND_VERS AND D.ORDINE = DD.ORDINE



WHERE 
D.STATUT = '1'
 AND    
 (D.RIND BETWEEN '2100' AND  '2302') 

ORDER BY 
ORDINE)D 