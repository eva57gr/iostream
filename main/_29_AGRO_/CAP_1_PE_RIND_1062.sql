--SQL Oracle - adauga coloanle care lipsesc la urmatoarele randuri '1117','1218','1631'
SELECT
    D.CUIIO,
    D.CUATM,
    R.DENUMIRE,
    C.FULL_CODE,
    NULLIF(SUM(CASE WHEN D.RIND IN ('1104') THEN D.COL1 ELSE 0 END), 0) AS R_1104_C1,
    NULLIF(SUM(CASE WHEN D.RIND IN ('1104') THEN D.COL2 ELSE 0 END), 0) AS R_1104_C2,
    NULLIF(SUM(CASE WHEN D.RIND IN ('1104') THEN D.COL3 ELSE 0 END), 0) AS R_1104_C3,
    NULLIF(SUM(CASE WHEN D.RIND IN ('1104') THEN D.COL4 ELSE 0 END), 0) AS R_1104_C4,
    NULLIF(SUM(CASE WHEN D.RIND IN ('1104') THEN D.COL5 ELSE 0 END), 0) AS R_1104_C5,
    NULLIF(SUM(CASE WHEN D.RIND IN ('1110') THEN D.COL1 ELSE 0 END), 0) AS R_1114_C1,
    NULLIF(SUM(CASE WHEN D.RIND IN ('1110') THEN D.COL2 ELSE 0 END), 0) AS R_1114_C2,
    NULLIF(SUM(CASE WHEN D.RIND IN ('1110') THEN D.COL3 ELSE 0 END), 0) AS R_1114_C3,
    NULLIF(SUM(CASE WHEN D.RIND IN ('1110') THEN D.COL4 ELSE 0 END), 0) AS R_1114_C4,
    NULLIF(SUM(CASE WHEN D.RIND IN ('1110') THEN D.COL5 ELSE 0 END), 0) AS R_1114_C5
    

   
FROM CIS2.VW_DATA_ALL D
         INNER JOIN CIS2.RENIM R ON R.CUIIO = D.CUIIO AND R.CUIIO_VERS = D.CUIIO_VERS
         INNER JOIN CIS2.VW_CL_CUATM C ON C.CODUL = D.CUATM
WHERE 
    D.PERIOADA IN (1060)
    AND D.FORM IN (45)
    AND D.capitol = 399
 
   AND D.RIND IN ('1104','1110','1117','1218','1631')
   
   
   GROUP BY
    D.CUIIO,
    D.CUATM,
    R.DENUMIRE,
    C.FULL_CODE
   
 
   
