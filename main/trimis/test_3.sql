SELECT 
    D.CUIIO,
    SUM(CASE WHEN D.PERIOADA = 1056 THEN D.COL1_1056 ELSE D.COL1_1057 END) AS COL1,
    SUM(CASE WHEN D.PERIOADA = 1056 THEN D.COL2_1056 ELSE D.COL2_1057 END) AS COL2
FROM
(
    SELECT 
        D.CUIIO,
        D.PERIOADA,
        SUM(D.COL4) - SUM(CASE WHEN D.PERIOADA = 1056 THEN 1688 ELSE 9806 END) AS COL1_1056,
        (SUM(D.COL4) / CR.COL1) - (SUM(CASE WHEN D.PERIOADA = 1056 THEN 1688 ELSE 9806 END) / 
        CASE WHEN D.PERIOADA = 1056 THEN 18.8453 ELSE 19.456 END) AS COL2_1056,
        SUM(CASE WHEN D.PERIOADA = 1057 THEN D.COL4 END) - 9806 AS COL1_1057,
        (SUM(CASE WHEN D.PERIOADA = 1057 THEN D.COL4 END) / 19.456) - (9806 / 19.456) AS COL2_1057
    FROM (
        SELECT 
            19206 AS CUIIO,
            1057 AS PERIOADA,
            9806 AS COL4
        FROM DUAL
        UNION ALL 
        SELECT 
            19206 AS CUIIO,
            1056 AS PERIOADA,
            1688 AS COL4
        FROM DUAL
    ) D
    CROSS JOIN (
        SELECT 
            D.PERIOADA,
            SUM(D.COL1) AS COL1
        FROM (
            SELECT 
                44519 AS ID_MD,
                1057 AS PERIOADA,
                19.456 AS COL1
            FROM DUAL
            UNION ALL
            SELECT 
                44519 AS ID_MD,
                1056 AS PERIOADA,
                18.8453 AS COL1
            FROM DUAL
        ) D
        WHERE D.PERIOADA = :pPERIOADA OR D.PERIOADA = :pPERIOADA-1
        GROUP BY D.PERIOADA
    ) CR
    WHERE D.CUIIO = 19206
    GROUP BY D.CUIIO, D.PERIOADA,CR.COL1
) D
GROUP BY D.CUIIO;
