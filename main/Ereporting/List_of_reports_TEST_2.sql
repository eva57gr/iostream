SELECT 
      DISTINCT           D.CUIIO, 
    LISTAGG( D.FORM, ',') WITHIN GROUP (ORDER BY  D.FORM) AS DEN_SHORT 
                
                
                        FROM CIS2.VW_DATA_ALL D
                        
                        WHERE 
                        
                        D.ANUL = 2022
                        
                        AND D.CUIIO IN (
                        41349476,
41000696,
40866092,
40220770,
41169047,
40774533,
41419515,
40065952,
20283170,
41290889,
41101569,
41286379,
40669115,
37787130
                        )
                        
                        GROUP BY 
                            D.CUIIO
                         --   D.FORM 
                
                
                ORDER BY 
                D.CUIIO
                
                
                -- I use this algoritm in this SQL 
                -- I get this 
                
      
                
                
--20283170	8
--37787130	3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,8,16,16,16,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71
--40065952	8
--40220770	8,8,8,8,8,8,8,8,8,8
--40774533	8
--40866092	8,8,8,8,8,8,8,8,44,44,44,44,44,44,44,44
--41000696	3
--41290889	3,8,8,8,8,8,8,8,8,8,8,8
--41349476	44,44,44,44,44,44,44,44,44,44,44,44,44,44
--41419515	3,8