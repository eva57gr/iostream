SELECT DISTINCT

SUM(CASE WHEN D.CAPITOL IN (1181) AND RIND IN ('130')   THEN  D.COL2 ELSE NULL END ) AS COL1,
SUM(CASE WHEN D.CAPITOL IN (1206) AND RIND IN ('900')   THEN  D.COL1 ELSE NULL END ) AS COL2,

SUM(CASE WHEN  RIND NOT IN ('900','130','110','111','112','113','120')   THEN  NVAL(D.COL1) + NVAL(D.COL2) ELSE NULL END ) AS COL3

FROM
VW_DATA_ALL  D                                  
WHERE
  (D.PERIOADA=:PERIOADA) AND
  (D.CUIIO=:CUIIO               OR :CUIIO = -1) AND
  (D.CUIIO_VERS=:CUIIO_VERS     OR :CUIIO_VERS = -1) AND
  (D.FORM = :FORM               OR :FORM = -1) AND
  (D.FORM_VERS=:FORM_VERS  OR :FORM_VERS = -1) AND
  (D.CAPITOL=:CAPITOL           OR :CAPITOL = -1) AND
  (D.CAPITOL_VERS=:CAPITOL_VERS OR :CAPITOL_VERS = -1) AND
  (D.ID_MD=:ID_MD               OR :ID_MD = -1) AND
 
  D.FORM = 71
  AND D.CAPITOL IN (1181,1182,1183,1184,1185,1186,1187,1204,1205,1206)

HAVING

(
SUM(CASE WHEN D.CAPITOL IN (1181) AND RIND IN ('130')   THEN  D.COL2 ELSE NULL END ) IS NOT NULL 
AND  SUM(CASE WHEN D.CAPITOL IN (1206) AND RIND IN ('900')   THEN  D.COL1 ELSE NULL END ) IS NULL 

)


OR 
(
SUM(CASE WHEN D.CAPITOL IN (1181) AND RIND IN ('130')   THEN  D.COL2 ELSE NULL END ) IS NOT NULL 
AND  SUM(CASE WHEN D.CAPITOL IN (1206) AND RIND IN ('900')   THEN  D.COL1 ELSE NULL END ) IS NOT NULL 

AND SUM(CASE WHEN  RIND NOT IN ('900','130','110','111','112','113','120')   THEN  NVAL(D.COL1) + NVAL(D.COL2) ELSE NULL END )   IS NOT NULL  
)
 