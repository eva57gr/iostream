SELECT DISTINCT 
  'Col.'||C.COL||' ('||
  ROUND(SUM(CASE WHEN D.RIND     IN('160') THEN DECODE(C.COL, 1,D.COL1, 2,D.COL2, 3,D.COL3, 4,D.COL4, 5,D.COL5, 6,D.COL6, 7,D.COL7, 8,D.COL8, 9,D.COL9, 10,D.COL10, 11,D.COL11, 12,D.COL12) ELSE 0 END),1)              ||' mii lei) nu apartine intervalului ['||
  ROUND(SUM(CASE WHEN D.RIND NOT IN('160') THEN DECODE(C.COL, 1,D.COL1, 2,D.COL2, 3,D.COL3, 4,D.COL4, 5,D.COL5, 6,D.COL6, 7,D.COL7, 8,D.COL8, 9,D.COL9, 10,D.COL10, 11,D.COL11, 12,D.COL12) ELSE 0 END * R.MINV)/1000,1)||' - '||
  ROUND(SUM(CASE WHEN D.RIND NOT IN('160') THEN DECODE(C.COL, 1,D.COL1, 2,D.COL2, 3,D.COL3, 4,D.COL4, 5,D.COL5, 6,D.COL6, 7,D.COL7, 8,D.COL8, 9,D.COL9, 10,D.COL10, 11,D.COL11, 12,D.COL12) ELSE 0 END * R.MAXV)/1000,1)||']'
  AS REZULTAT
FROM
  VW_DATA_ALL_TEMP D,
  (
--    SELECT 1  AS COL FROM DUAL UNION
    SELECT 2  AS COL FROM DUAL UNION
    SELECT 3  AS COL FROM DUAL UNION
    SELECT 4  AS COL FROM DUAL UNION
    SELECT 5  AS COL FROM DUAL UNION
    SELECT 6  AS COL FROM DUAL UNION
    SELECT 7  AS COL FROM DUAL UNION
    SELECT 8  AS COL FROM DUAL UNION
    SELECT 9  AS COL FROM DUAL UNION
    SELECT 10 AS COL FROM DUAL UNION
    SELECT 11 AS COL FROM DUAL UNION
    SELECT 12 AS COL FROM DUAL
  ) C,
  (
    SELECT '20'  AS RIND, 0 MINV, 4000.00 MAXV FROM DUAL UNION
    SELECT '30'  AS RIND, 4000.00 MINV,  4000.00 MAXV FROM DUAL UNION 
    SELECT '40'  AS RIND, 4000.01 MINV,  5000.00 MAXV FROM DUAL UNION
    SELECT '50'  AS RIND, 5000.01 MINV,  6000.00 MAXV FROM DUAL UNION
    SELECT '60'  AS RIND, 6000.01 MINV,  7000.00 MAXV FROM DUAL UNION
    SELECT '70'  AS RIND, 7000.01 MINV,  8000.00 MAXV FROM DUAL UNION
    SELECT '80'  AS RIND, 8000.01 MINV,  10000.00 MAXV FROM DUAL UNION
    SELECT '90'  AS RIND, 10000.01 MINV, 15000.00 MAXV FROM DUAL UNION
    SELECT '100' AS RIND, 15000.01 MINV, 20000.00 MAXV FROM DUAL UNION
  
    SELECT '110' AS RIND, 20000.01 MINV, 25000.00 MAXV FROM DUAL UNION
    
    SELECT '120' AS RIND, 25000.01 MINV, 30000.00 MAXV FROM DUAL UNION
    
    SELECT '130' AS RIND, 30000.01 MINV, 40000.00 MAXV FROM DUAL UNION
    
    SELECT '160' AS RIND,    0 MINV, 40000.00 MAXV FROM DUAL
  ) R
WHERE
  (D.PERIOADA=:PERIOADA         OR :PERIOADA = -1) AND
  (D.CUIIO=:CUIIO               OR :CUIIO = -1) AND
  (D.CUIIO_VERS=:CUIIO_VERS     OR :CUIIO_VERS = -1) AND
  (D.FORM = :FORM               OR :FORM = -1) AND
  (D.FORM_VERS=:FORM_VERS       OR :FORM_VERS = -1) AND
  (D.CAPITOL=:CAPITOL           OR :CAPITOL = -1) AND
  (D.CAPITOL_VERS=:CAPITOL_VERS OR :CAPITOL_VERS = -1) AND
  (D.ID_MD=:ID_MD               OR :ID_MD = -1) AND
  
  D.FORM IN (7)  AND
  D.CAPITOL in (40) AND
  D.RIND = R.RIND
GROUP BY
  C.COL  
HAVING
  
  ROUND(SUM(CASE WHEN D.RIND     IN('160') THEN DECODE(C.COL, 1,D.COL1, 2,D.COL2, 3,D.COL3, 4,D.COL4, 5,D.COL5, 6,D.COL6, 7,D.COL7, 8,D.COL8, 9,D.COL9, 10,D.COL10, 11,D.COL11, 12,D.COL12) ELSE 0 END),1) <
  ROUND(SUM(CASE WHEN D.RIND NOT IN('160') THEN DECODE(C.COL, 1,D.COL1, 2,D.COL2, 3,D.COL3, 4,D.COL4, 5,D.COL5, 6,D.COL6, 7,D.COL7, 8,D.COL8, 9,D.COL9, 10,D.COL10, 11,D.COL11, 12,D.COL12) ELSE 0 END * R.MINV)/1000,1)
  
  OR
  
  ROUND(SUM(CASE WHEN D.RIND     IN('160') THEN DECODE(C.COL, 1,D.COL1, 2,D.COL2, 3,D.COL3, 4,D.COL4, 5,D.COL5, 6,D.COL6, 7,D.COL7, 8,D.COL8, 9,D.COL9, 10,D.COL10, 11,D.COL11, 12,D.COL12) ELSE 0 END),1) >
  ROUND(SUM(CASE WHEN D.RIND NOT IN('160') THEN DECODE(C.COL, 1,D.COL1, 2,D.COL2, 3,D.COL3, 4,D.COL4, 5,D.COL5, 6,D.COL6, 7,D.COL7, 8,D.COL8, 9,D.COL9, 10,D.COL10, 11,D.COL11, 12,D.COL12) ELSE 0 END * R.MAXV)/1000,1)