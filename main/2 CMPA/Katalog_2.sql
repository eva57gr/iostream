
SELECT 
   DISTINCT  D.UNIT_CODE
--    COUNT(DISTINCT CASE WHEN D.RIND IN ('0')  THEN D.UNIT_CODE  ELSE NULL END) AS COL1,
--    COUNT(DISTINCT CASE WHEN D.RIND NOT IN ('TIP2', 'TIP3','0','CA','-')   THEN D.UNIT_CODE  ELSE NULL END) AS COL2,
--    COUNT(DISTINCT CASE WHEN D.RIND  IN ('1','2','3','4','5','6','7','8','9')   THEN D.UNIT_CODE  ELSE NULL END) AS COL3
    


FROM
  VW_DATA_ALL_GC  D
 
WHERE
  (D.PERIOADA IN (:pPERIOADA))  AND   
  (D.FORM =:pFORM) AND
  (D.FORM_VERS =:pFORM_VERS) AND 
  (:pID_MDTABLE =:pID_MDTABLE) AND
  D.FORM IN (58)  AND
  D.CAPITOL IN (419)
  
  
GROUP BY
D.UNIT_CODE

HAVING 
--COUNT(DISTINCT CASE WHEN D.RIND  IN ('0')  THEN D.UNIT_CODE  ELSE NULL END) <> 1 
--AND 
COUNT(DISTINCT CASE WHEN D.RIND  IN ('1','2','3','4','5','6','7','8')   THEN D.UNIT_CODE  ELSE NULL END) =   1
--AND 

--COUNT(DISTINCT CASE WHEN D.RIND NOT IN ('TIP2', 'TIP3','0','CA','-')   THEN D.UNIT_CODE  ELSE NULL END) <> 1 


--
--ORDER BY 
--
--COL1 DESC
