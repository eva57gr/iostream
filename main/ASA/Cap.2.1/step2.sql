SELECT 
TR.ORDINE||' -- '||TR.FORMULA ||' -- '||
 SUM(DISTINCT CASE WHEN D.CAPITOL IN (TR.CAPITOL) AND 
 D.RIND IN (TR.RIND1) 
 THEN NVAL(D.COL1) ELSE 0 END) ||' < '||  SUM(DISTINCT CASE WHEN D.CAPITOL IN (TR.CAPITOL) AND 
 D.RIND IN (TR.RIND2,TR.RIND3,TR.RIND4) 
 THEN NVAL(D.COL1) ELSE 0 END) 
 
 
 AS REZULTAT
 
  
FROM 

(
SELECT
   D.CUIIO,
  D.CAPITOL,
  D.CAPITOL_DEN,
  D.RIND,
  D.CAEM2,
  D.COL1

  

FROM
 CIS2.VW_DATA_ALL D 
 
WHERE
  (D.PERIOADA=:PERIOADA          ) AND
  (D.CUIIO=:CUIIO                ) AND
  (D.CUIIO_VERS=:CUIIO_VERS     OR :CUIIO_VERS = -1) AND
  (D.FORM = :FORM               ) AND
  (D.FORM_VERS=:FORM_VERS ) AND
  (D.CAPITOL=:CAPITOL           OR :CAPITOL = -1) AND
  (D.CAPITOL_VERS=:CAPITOL_VERS OR :CAPITOL_VERS = -1) AND
  (D.ID_MD=:ID_MD               OR :ID_MD = -1) AND
  

  D.CAPITOL IN (1200) 
 

)   D


CROSS JOIN
 (

SELECT 1200 AS CAPITOL, 'Rind: 2101-1 >=  2101-2 + 2101-3 + 2101-4' AS FORMULA,'2101-1' AS RIND1, '2101-2' AS RIND2,'2101-3' AS RIND3,'2101-4' AS RIND4, '64-102' AS ORDINE    
FROM DUAL 

UNION 

SELECT 1200 AS CAPITOL, 'Rind: 2102-1 >=  2102-2 + 2102-3 + 2102-4' AS FORMULA,'2102-1' AS RIND1, '2102-2' AS RIND2,'2102-3' AS RIND3,'2102-4' AS RIND4, '64-103' AS ORDINE
FROM DUAL 

UNION 

SELECT 1200 AS CAPITOL, 'Rind: 2103-1 >=  2103-2 + 2103-3 + 2103-4' AS FORMULA,'2103-1' AS RIND1, '2103-2' AS RIND2,'2103-3' AS RIND3,'2103-4' AS RIND4, '64-104' AS ORDINE
FROM DUAL 


UNION 

SELECT 1200 AS CAPITOL, 'Rind: 2104-1 >=  2104-2 + 2103-4 + 2104-4' AS FORMULA,'2104-1' AS RIND1, '2103-2' AS RIND2,'2103-3' AS RIND3,'2103-4' AS RIND4, '64-105' AS ORDINE
FROM DUAL 


UNION 

SELECT 1200 AS CAPITOL, 'Rind: 2105-1 >=  2105-2 + 2105-4 + 2105-4' AS FORMULA,'2105-1' AS RIND1, '2105-2' AS RIND2,'2105-3' AS RIND3,'2105-4' AS RIND4, '64-106' AS ORDINE
FROM DUAL 

UNION 

SELECT 1200 AS CAPITOL, 'Rind: 2106-1 >=  2106-2 + 2106-4 + 2106-4' AS FORMULA,'2106-1' AS RIND1, '2106-2' AS RIND2,'2106-3' AS RIND3,'2106-4' AS RIND4, '64-107' AS ORDINE
FROM DUAL 


UNION 

SELECT 1200 AS CAPITOL, 'Rind: 2107-1 >=  2107-2 + 2107-4 + 2107-4' AS FORMULA,'2107-1' AS RIND1, '2107-2' AS RIND2,'2107-3' AS RIND3,'2107-4' AS RIND4, '64-108' AS ORDINE
FROM DUAL 


UNION 

SELECT 1200 AS CAPITOL, 'Rind: 2108-1 >=  2108-2 + 2108-4 + 2108-4' AS FORMULA,'2108-1' AS RIND1, '2108-2' AS RIND2,'2108-3' AS RIND3,'2108-4' AS RIND4, '64-109' AS ORDINE
FROM DUAL 


UNION 

SELECT 1200 AS CAPITOL, 'Rind: 2109-1 >=  2109-2 + 2109-4 + 2109-4' AS FORMULA,'2109-1' AS RIND1, '2109-2' AS RIND2,'2109-3' AS RIND3,'2109-4' AS RIND4, '64-110' AS ORDINE
FROM DUAL 


UNION 

SELECT 1200 AS CAPITOL, 'Rind: 2110-1 >=  2110-2 + 2110-4 + 2110-4' AS FORMULA,'2110-1' AS RIND1, '2110-2' AS RIND2,'2110-3' AS RIND3,'2110-4' AS RIND4, '64-111' AS ORDINE
FROM DUAL 


UNION 

SELECT 1200 AS CAPITOL, 'Rind: 2111-1 >=  2111-2 + 2111-4 + 2111-4' AS FORMULA,'2111-1' AS RIND1, '2111-2' AS RIND2,'2111-3' AS RIND3,'2111-4' AS RIND4, '64-112' AS ORDINE
FROM DUAL 

UNION 

SELECT 1200 AS CAPITOL, 'Rind: 2112-1 >=  2112-2 + 2112-4 + 2112-4' AS FORMULA,'2112-1' AS RIND1, '2112-2' AS RIND2,'2112-3' AS RIND3,'2112-4' AS RIND4, '64-113' AS ORDINE
FROM DUAL 


UNION 

SELECT 1200 AS CAPITOL, 'Rind: 2113-1 >=  2113-2 + 2113-4 + 2113-4' AS FORMULA,'2113-1' AS RIND1, '2113-2' AS RIND2,'2113-3' AS RIND3,'2113-4' AS RIND4, '64-114' AS ORDINE
FROM DUAL 


UNION 

SELECT 1200 AS CAPITOL, 'Rind: 2114-1 >=  2114-2 + 2114-4 + 2114-4' AS FORMULA,'2114-1' AS RIND1, '2114-2' AS RIND2,'2114-3' AS RIND3,'2114-4' AS RIND4, '64-115' AS ORDINE
FROM DUAL 


UNION 

SELECT 1200 AS CAPITOL, 'Rind: 2115-1 >=  2115-2 + 2115-4 + 2115-4' AS FORMULA,'2115-1' AS RIND1, '2115-2' AS RIND2,'2115-3' AS RIND3,'2115-4' AS RIND4, '64-116' AS ORDINE
FROM DUAL 

UNION 

SELECT 1200 AS CAPITOL, 'Rind: 2116-1 >=  2116-2 + 2116-4 + 2116-4' AS FORMULA,'2116-1' AS RIND1, '2116-2' AS RIND2,'2116-3' AS RIND3,'2116-4' AS RIND4, '64-117' AS ORDINE
FROM DUAL 

UNION 

SELECT 1200 AS CAPITOL, 'Rind: 2117-1 >=  2117-2 + 2117-4 + 2117-4' AS FORMULA,'2117-1' AS RIND1, '2117-2' AS RIND2,'2117-3' AS RIND3,'2117-4' AS RIND4, '64-118' AS ORDINE
FROM DUAL 


UNION 

SELECT 1200 AS CAPITOL, 'Rind: 2118-1 >=  2118-2 + 2118-4 + 2118-4' AS FORMULA,'2118-1' AS RIND1, '2118-2' AS RIND2,'2118-3' AS RIND3,'2118-4' AS RIND4, '64-119' AS ORDINE
FROM DUAL 


UNION 

SELECT 1200 AS CAPITOL, 'Rind: 2119-1 >=  2119-2 + 2119-4 + 2119-4' AS FORMULA,'2119-1' AS RIND1, '2119-2' AS RIND2,'2119-3' AS RIND3,'2119-4' AS RIND4, '64-120' AS ORDINE
FROM DUAL

UNION 

SELECT 1200 AS CAPITOL, 'Rind: 2120-1 >=  2120-2 + 2120-4 + 2120-4' AS FORMULA,'2120-1' AS RIND1, '2120-2' AS RIND2,'2120-3' AS RIND3,'2120-4' AS RIND4, '64-121' AS ORDINE
FROM DUAL



UNION 

SELECT 1200 AS CAPITOL, 'Rind: 2121-1 >=  2121-2 + 2121-4 + 2121-4' AS FORMULA,'2121-1' AS RIND1, '2121-2' AS RIND2,'2121-3' AS RIND3,'2121-4' AS RIND4, '64-122' AS ORDINE
FROM DUAL

 
UNION 

SELECT 1200 AS CAPITOL, 'Rind: 2122-1 >=  2122-2 + 2122-4 + 2122-4' AS FORMULA,'2122-1' AS RIND1, '2122-2' AS RIND2,'2122-3' AS RIND3,'2122-4' AS RIND4, '64-123' AS ORDINE
FROM DUAL


UNION 

SELECT 1200 AS CAPITOL, 'Rind: 2123-1 >=  2123-2 + 2123-4 + 2123-4' AS FORMULA,'2123-1' AS RIND1, '2123-2' AS RIND2,'2123-3' AS RIND3,'2123-4' AS RIND4, '64-124' AS ORDINE
FROM DUAL


UNION 

SELECT 1200 AS CAPITOL, 'Rind: 2124-1 >=  2124-2 + 2124-4 + 2124-4' AS FORMULA,'2124-1' AS RIND1, '2124-2' AS RIND2,'2124-3' AS RIND3,'2124-4' AS RIND4, '64-125' AS ORDINE
FROM DUAL

UNION 

SELECT 1200 AS CAPITOL, 'Rind: 2125-1 >=  2125-2 + 2125-4 + 2125-4' AS FORMULA,'2125-1' AS RIND1, '2125-2' AS RIND2,'2125-3' AS RIND3,'2125-4' AS RIND4, '64-126' AS ORDINE
FROM DUAL

UNION 

SELECT 1200 AS CAPITOL, 'Rind: 2126-1 >=  2126-2 + 2126-4 + 2126-4' AS FORMULA,'2126-1' AS RIND1, '2126-2' AS RIND2,'2126-3' AS RIND3,'2126-4' AS RIND4, '64-127' AS ORDINE
FROM DUAL

UNION 

SELECT 1200 AS CAPITOL, 'Rind: 2127-1 >=  2127-2 + 2127-4 + 2127-4' AS FORMULA,'2127-1' AS RIND1, '2127-2' AS RIND2,'2127-3' AS RIND3,'2127-4' AS RIND4, '64-128' AS ORDINE
FROM DUAL


UNION 

SELECT 1200 AS CAPITOL, 'Rind: 2128-1 >=  2128-2 + 2128-4 + 2128-4' AS FORMULA,'2128-1' AS RIND1, '2128-2' AS RIND2,'2128-3' AS RIND3,'2128-4' AS RIND4, '64-129' AS ORDINE
FROM DUAL


UNION 

SELECT 1200 AS CAPITOL, 'Rind: 2129-1 >=  2129-2 + 2129-4 + 2129-4' AS FORMULA,'2129-1' AS RIND1, '2129-2' AS RIND2,'2129-3' AS RIND3,'2129-4' AS RIND4, '64-130' AS ORDINE
FROM DUAL


UNION 

SELECT 1200 AS CAPITOL, 'Rind: 2130-1 >=  2130-2 + 2130-4 + 2130-4' AS FORMULA,'2130-1' AS RIND1, '2130-2' AS RIND2,'2130-3' AS RIND3,'2130-4' AS RIND4, '64-131' AS ORDINE
FROM DUAL


) TR

 GROUP BY
 TR.ORDINE,
 TR.FORMULA
--  D.CUIIO
  

HAVING 

SUM(DISTINCT CASE WHEN D.CAPITOL IN (TR.CAPITOL) AND 
 D.RIND IN (TR.RIND1) 
 THEN NVAL(D.COL1) ELSE 0 END)  <  SUM(DISTINCT CASE WHEN D.CAPITOL IN (TR.CAPITOL) AND 
 D.RIND IN (TR.RIND2,TR.RIND3,TR.RIND4) 
 THEN NVAL(D.COL1) ELSE 0 END)  
 

 