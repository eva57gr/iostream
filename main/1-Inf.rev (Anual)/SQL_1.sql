SELECT
      DISTINCT  D.CUIIO,
       R.IDNO,
       R.DENUMIRE,
       C4.CODUL4,
       R.CUATM,
       R.CAEM2,
       C.FULL_CODE,
       SUM(CASE WHEN D.CAPITOL = 1181 AND  D.RIND IN ('110') THEN  D.COL1 ELSE NULL END ) AS  R_110_COL1,
       SUM(CASE WHEN D.CAPITOL = 1181 AND  D.RIND IN ('111') THEN  D.COL1 ELSE NULL END ) AS  R_111_COL1,
       SUM(CASE WHEN D.CAPITOL = 1181 AND  D.RIND IN ('112') THEN  D.COL1 ELSE NULL END ) AS  R_112_COL1, 
       SUM(CASE WHEN D.CAPITOL = 1181 AND  D.RIND IN ('113') THEN  D.COL1 ELSE NULL END ) AS  R_113_COL1,  
       SUM(CASE WHEN D.CAPITOL = 1181 AND  D.RIND IN ('120') THEN  D.COL1 ELSE NULL END ) AS  R_120_COL1,
       SUM(CASE WHEN D.CAPITOL = 1181 AND  D.RIND IN ('130') THEN  D.COL1 ELSE NULL END ) AS  R_130_COL1,
       SUM(CASE WHEN D.CAPITOL = 1181 AND  D.RIND IN ('130') THEN  D.COL2 ELSE NULL END ) AS  R_130_COL2,
       SUM(CASE WHEN D.CAPITOL = 1181 AND  D.RIND IN ('140') THEN  D.COL1 ELSE NULL END ) AS  R_140_COL1,
       SUM(CASE WHEN D.CAPITOL = 1181 AND  D.RIND IN ('140') THEN  D.COL2 ELSE NULL END ) AS  R_140_COL2,
       SUM(CASE WHEN D.CAPITOL = 1181 AND  D.RIND IN ('141') THEN  D.COL1 ELSE NULL END ) AS  R_141_COL1,
       SUM(CASE WHEN D.CAPITOL = 1181 AND  D.RIND IN ('150') THEN  D.COL1 ELSE NULL END ) AS  R_150_COL1,
       SUM(CASE WHEN D.CAPITOL = 1181 AND  D.RIND IN ('150') THEN  D.COL2 ELSE NULL END ) AS  R_150_COL2,
       SUM(CASE WHEN D.CAPITOL = 1181 AND  D.RIND IN ('161') THEN  D.COL1 ELSE NULL END ) AS  R_161_COL1,
       SUM(CASE WHEN D.CAPITOL = 1181 AND  D.RIND IN ('162') THEN  D.COL1 ELSE NULL END ) AS  R_162_COL1,
       SUM(CASE WHEN D.CAPITOL = 1181 AND  D.RIND IN ('163') THEN  D.COL1 ELSE NULL END ) AS  R_163_COL1,
       SUM(CASE WHEN D.CAPITOL = 1181 AND  D.RIND IN ('164') THEN  D.COL1 ELSE NULL END ) AS  R_164_COL1,
       SUM(CASE WHEN D.CAPITOL = 1181 AND  D.RIND IN ('165') THEN  D.COL1 ELSE NULL END ) AS  R_165_COL1,
       SUM(CASE WHEN D.CAPITOL = 1181 AND  D.RIND IN ('170') THEN  D.COL1 ELSE NULL END ) AS  R_170_COL1,
       SUM(CASE WHEN D.CAPITOL = 1181 AND  D.RIND IN ('170') THEN  D.COL2 ELSE NULL END ) AS  R_170_COL2,
       SUM(CASE WHEN D.CAPITOL = 1181 AND  D.RIND IN ('180') THEN  D.COL1 ELSE NULL END ) AS  R_180_COL1,
       SUM(CASE WHEN D.CAPITOL = 1181 AND  D.RIND IN ('180') THEN  D.COL2 ELSE NULL END ) AS  R_180_COL2,
       SUM(CASE WHEN D.CAPITOL = 1181 AND  D.RIND IN ('181') THEN  D.COL1 ELSE NULL END ) AS  R_181_COL1,    
       SUM(CASE WHEN D.CAPITOL = 1182 AND  D.RIND IN ('210') THEN  D.COL1 ELSE NULL END ) AS  R_210_COL1,
       SUM(CASE WHEN D.CAPITOL = 1182 AND  D.RIND IN ('210') THEN  D.COL2 ELSE NULL END ) AS  R_210_COL2,
       SUM(CASE WHEN D.CAPITOL = 1182 AND  D.RIND IN ('221') THEN  D.COL1 ELSE NULL END ) AS  R_221_COL1,
       SUM(CASE WHEN D.CAPITOL = 1182 AND  D.RIND IN ('221') THEN  D.COL2 ELSE NULL END ) AS  R_221_COL2,
       
       SUM(CASE WHEN D.CAPITOL = 1182 AND  D.RIND IN ('222') THEN  D.COL1 ELSE NULL END ) AS  R_222_COL1,
       SUM(CASE WHEN D.CAPITOL = 1182 AND  D.RIND IN ('222') THEN  D.COL2 ELSE NULL END ) AS  R_222_COL2,
       
       SUM(CASE WHEN D.CAPITOL = 1182 AND  D.RIND IN ('223') THEN  D.COL1 ELSE NULL END ) AS  R_223_COL1,
       SUM(CASE WHEN D.CAPITOL = 1182 AND  D.RIND IN ('223') THEN  D.COL2 ELSE NULL END ) AS  R_223_COL2,
       
       SUM(CASE WHEN D.CAPITOL = 1182 AND  D.RIND IN ('224') THEN  D.COL1 ELSE NULL END ) AS  R_224_COL1,
       SUM(CASE WHEN D.CAPITOL = 1182 AND  D.RIND IN ('224') THEN  D.COL2 ELSE NULL END ) AS  R_224_COL2,
       
       SUM(CASE WHEN D.CAPITOL = 1183 AND  D.RIND IN ('310') THEN  D.COL1 ELSE NULL END ) AS  R_310_COL1,
       SUM(CASE WHEN D.CAPITOL = 1183 AND  D.RIND IN ('310') THEN  D.COL2 ELSE NULL END ) AS  R_310_COL2,
       
       
       SUM(CASE WHEN D.CAPITOL = 1183 AND  D.RIND IN ('321') THEN  D.COL1 ELSE NULL END ) AS  R_321_COL1,
       SUM(CASE WHEN D.CAPITOL = 1183 AND  D.RIND IN ('321') THEN  D.COL2 ELSE NULL END ) AS  R_321_COL2,
       
       
       SUM(CASE WHEN D.CAPITOL = 1183 AND  D.RIND IN ('322') THEN  D.COL1 ELSE NULL END ) AS  R_322_COL1,
       SUM(CASE WHEN D.CAPITOL = 1183 AND  D.RIND IN ('322') THEN  D.COL2 ELSE NULL END ) AS  R_322_COL2,
       
        
       SUM(CASE WHEN D.CAPITOL = 1183 AND  D.RIND IN ('323') THEN  D.COL1 ELSE NULL END ) AS  R_323_COL1,
       SUM(CASE WHEN D.CAPITOL = 1183 AND  D.RIND IN ('323') THEN  D.COL2 ELSE NULL END ) AS  R_323_COL2,              
       
       SUM(CASE WHEN D.CAPITOL = 1183 AND  D.RIND IN ('324') THEN  D.COL1 ELSE NULL END ) AS  R_324_COL1,
       SUM(CASE WHEN D.CAPITOL = 1183 AND  D.RIND IN ('324') THEN  D.COL2 ELSE NULL END ) AS  R_324_COL2, 
       
       SUM(CASE WHEN D.CAPITOL = 1183 AND  D.RIND IN ('325') THEN  D.COL1 ELSE NULL END ) AS  R_325_COL1,
       SUM(CASE WHEN D.CAPITOL = 1183 AND  D.RIND IN ('325') THEN  D.COL2 ELSE NULL END ) AS  R_325_COL2,
       
       SUM(CASE WHEN D.CAPITOL = 1183 AND  D.RIND IN ('326') THEN  D.COL1 ELSE NULL END ) AS  R_326_COL1,
       SUM(CASE WHEN D.CAPITOL = 1183 AND  D.RIND IN ('326') THEN  D.COL2 ELSE NULL END ) AS  R_326_COL2,
       
              
       SUM(CASE WHEN D.CAPITOL = 1183 AND  D.RIND IN ('327') THEN  D.COL1 ELSE NULL END ) AS  R_327_COL1,
       SUM(CASE WHEN D.CAPITOL = 1183 AND  D.RIND IN ('327') THEN  D.COL2 ELSE NULL END ) AS  R_327_COL2,
       
       SUM(CASE WHEN D.CAPITOL = 1183 AND  D.RIND IN ('328') THEN  D.COL1 ELSE NULL END ) AS  R_328_COL1,
       SUM(CASE WHEN D.CAPITOL = 1183 AND  D.RIND IN ('328') THEN  D.COL2 ELSE NULL END ) AS  R_328_COL2,
       
       SUM(CASE WHEN D.CAPITOL = 1183 AND  D.RIND IN ('329') THEN  D.COL1 ELSE NULL END ) AS  R_329_COL1,
       SUM(CASE WHEN D.CAPITOL = 1183 AND  D.RIND IN ('329') THEN  D.COL2 ELSE NULL END ) AS  R_329_COL2,
       
       SUM(CASE WHEN D.CAPITOL = 1183 AND  D.RIND IN ('330') THEN  D.COL1 ELSE NULL END ) AS  R_330_COL1,
       SUM(CASE WHEN D.CAPITOL = 1183 AND  D.RIND IN ('330') THEN  D.COL2 ELSE NULL END ) AS  R_330_COL2,
       
       
       SUM(CASE WHEN D.CAPITOL = 1184 AND  D.RIND IN ('411') THEN  D.COL1 ELSE NULL END ) AS  R_411_COL1,
       SUM(CASE WHEN D.CAPITOL = 1184 AND  D.RIND IN ('411') THEN  D.COL2 ELSE NULL END ) AS  R_411_COL2,
       
        SUM(CASE WHEN D.CAPITOL = 1184 AND  D.RIND IN ('412') THEN  D.COL1 ELSE NULL END ) AS  R_412_COL1,
       SUM(CASE WHEN D.CAPITOL = 1184 AND  D.RIND IN ('412') THEN  D.COL2 ELSE NULL END ) AS  R_412_COL2,
       
       SUM(CASE WHEN D.CAPITOL = 1184 AND  D.RIND IN ('413') THEN  D.COL1 ELSE NULL END ) AS  R_413_COL1,
       SUM(CASE WHEN D.CAPITOL = 1184 AND  D.RIND IN ('413') THEN  D.COL2 ELSE NULL END ) AS  R_413_COL2,
       
       SUM(CASE WHEN D.CAPITOL = 1184 AND  D.RIND IN ('414') THEN  D.COL1 ELSE NULL END ) AS  R_414_COL1,
       SUM(CASE WHEN D.CAPITOL = 1184 AND  D.RIND IN ('414') THEN  D.COL2 ELSE NULL END ) AS  R_414_COL2,
       
       SUM(CASE WHEN D.CAPITOL = 1184 AND  D.RIND IN ('415') THEN  D.COL1 ELSE NULL END ) AS  R_415_COL1,
       SUM(CASE WHEN D.CAPITOL = 1184 AND  D.RIND IN ('415') THEN  D.COL2 ELSE NULL END ) AS  R_415_COL2,
       
          
       SUM(CASE WHEN D.CAPITOL = 1184 AND  D.RIND IN ('416') THEN  D.COL1 ELSE NULL END ) AS  R_416_COL1,
       SUM(CASE WHEN D.CAPITOL = 1184 AND  D.RIND IN ('416') THEN  D.COL2 ELSE NULL END ) AS  R_416_COL2,
       
       
       SUM(CASE WHEN D.CAPITOL = 1184 AND  D.RIND IN ('417') THEN  D.COL1 ELSE NULL END ) AS  R_417_COL1,
       SUM(CASE WHEN D.CAPITOL = 1184 AND  D.RIND IN ('417') THEN  D.COL2 ELSE NULL END ) AS  R_417_COL2,
       
       SUM(CASE WHEN D.CAPITOL = 1184 AND  D.RIND IN ('418') THEN  D.COL1 ELSE NULL END ) AS  R_418_COL1,
       SUM(CASE WHEN D.CAPITOL = 1184 AND  D.RIND IN ('418') THEN  D.COL2 ELSE NULL END ) AS  R_418_COL2,  
       
       SUM(CASE WHEN D.CAPITOL = 1184 AND  D.RIND IN ('419') THEN  D.COL1 ELSE NULL END ) AS  R_419_COL1,
       SUM(CASE WHEN D.CAPITOL = 1184 AND  D.RIND IN ('419') THEN  D.COL2 ELSE NULL END ) AS  R_419_COL2,  
                                          
       
       SUM(CASE WHEN D.CAPITOL = 1184 AND  D.RIND IN ('420') THEN  D.COL1 ELSE NULL END ) AS  R_420_COL1,
       SUM(CASE WHEN D.CAPITOL = 1184 AND  D.RIND IN ('420') THEN  D.COL2 ELSE NULL END ) AS  R_420_COL2, 
       
              
       SUM(CASE WHEN D.CAPITOL = 1184 AND  D.RIND IN ('430') THEN  D.COL1 ELSE NULL END ) AS  R_430_COL1,
       SUM(CASE WHEN D.CAPITOL = 1184 AND  D.RIND IN ('430') THEN  D.COL2 ELSE NULL END ) AS  R_430_COL2, 
       
       
                     
       SUM(CASE WHEN D.CAPITOL = 1184 AND  D.RIND IN ('421') THEN  D.COL1 ELSE NULL END ) AS  R_421_COL1,
       SUM(CASE WHEN D.CAPITOL = 1184 AND  D.RIND IN ('421') THEN  D.COL2 ELSE NULL END ) AS  R_421_COL2, 
       
       
        SUM(CASE WHEN D.CAPITOL = 1184 AND  D.RIND IN ('422') THEN  D.COL1 ELSE NULL END ) AS  R_422_COL1,
       SUM(CASE WHEN D.CAPITOL = 1184 AND  D.RIND IN ('422') THEN  D.COL2 ELSE NULL END ) AS  R_422_COL2, 
            
       
        SUM(CASE WHEN D.CAPITOL = 1184 AND  D.RIND IN ('423') THEN  D.COL1 ELSE NULL END ) AS  R_423_COL1,
       SUM(CASE WHEN D.CAPITOL = 1184 AND  D.RIND IN ('423') THEN  D.COL2 ELSE NULL END ) AS  R_423_COL2,
       
       
         SUM(CASE WHEN D.CAPITOL = 1185 AND  D.RIND IN ('511') THEN  D.COL1 ELSE NULL END ) AS  R_511_COL1,
       SUM(CASE WHEN D.CAPITOL = 1185 AND  D.RIND IN ('511') THEN  D.COL2 ELSE NULL END ) AS  R_511_COL2,
       
        SUM(CASE WHEN D.CAPITOL = 1185 AND  D.RIND IN ('512') THEN  D.COL1 ELSE NULL END ) AS  R_512_COL1,
       SUM(CASE WHEN D.CAPITOL = 1185 AND  D.RIND IN ('512') THEN  D.COL2 ELSE NULL END ) AS  R_512_COL2,
       
               SUM(CASE WHEN D.CAPITOL = 1185 AND  D.RIND IN ('513') THEN  D.COL1 ELSE NULL END ) AS  R_513_COL1,
       SUM(CASE WHEN D.CAPITOL = 1185 AND  D.RIND IN ('513') THEN  D.COL2 ELSE NULL END ) AS  R_513_COL2 ,
       
       SUM(CASE WHEN D.CAPITOL = 1185 AND  D.RIND IN ('514') THEN  D.COL1 ELSE NULL END ) AS  R_514_COL1,
       SUM(CASE WHEN D.CAPITOL = 1185 AND  D.RIND IN ('514') THEN  D.COL2 ELSE NULL END ) AS  R_514_COL2,
       
       SUM(CASE WHEN D.CAPITOL = 1185 AND  D.RIND IN ('515') THEN  D.COL1 ELSE NULL END ) AS  R_515_COL1,
       SUM(CASE WHEN D.CAPITOL = 1185 AND  D.RIND IN ('515') THEN  D.COL2 ELSE NULL END ) AS  R_515_COL2,
       
       SUM(CASE WHEN D.CAPITOL = 1185 AND  D.RIND IN ('520') THEN  D.COL1 ELSE NULL END ) AS  R_520_COL1,
       SUM(CASE WHEN D.CAPITOL = 1185 AND  D.RIND IN ('520') THEN  D.COL2 ELSE NULL END ) AS  R_520_COL2,
       
        SUM(CASE WHEN D.CAPITOL = 1186 AND  D.RIND IN ('611') THEN  D.COL1 ELSE NULL END ) AS  R_611_COL1,
       SUM(CASE WHEN D.CAPITOL = 1186 AND  D.RIND IN ('611') THEN  D.COL2 ELSE NULL END ) AS  R_611_COL2 ,
       
       
        SUM(CASE WHEN D.CAPITOL = 1186 AND  D.RIND IN ('612') THEN  D.COL1 ELSE NULL END ) AS  R_612_COL1,
       SUM(CASE WHEN D.CAPITOL = 1186 AND  D.RIND IN ('612') THEN  D.COL2 ELSE NULL END ) AS  R_612_COL2,
       
          SUM(CASE WHEN D.CAPITOL = 1186 AND  D.RIND IN ('651') THEN  D.COL1 ELSE NULL END ) AS  R_651_COL1,
       SUM(CASE WHEN D.CAPITOL = 1186 AND  D.RIND IN ('651') THEN  D.COL2 ELSE NULL END ) AS  R_651_COL2,
       
           SUM(CASE WHEN D.CAPITOL = 1186 AND  D.RIND IN ('652') THEN  D.COL1 ELSE NULL END ) AS  R_652_COL1,
       SUM(CASE WHEN D.CAPITOL = 1186 AND  D.RIND IN ('652') THEN  D.COL2 ELSE NULL END ) AS  R_652_COL2,
       
           SUM(CASE WHEN D.CAPITOL = 1186 AND  D.RIND IN ('653') THEN  D.COL1 ELSE NULL END ) AS  R_653_COL1,
       SUM(CASE WHEN D.CAPITOL = 1186 AND  D.RIND IN ('653') THEN  D.COL2 ELSE NULL END ) AS  R_653_COL2,
                                      
                 SUM(CASE WHEN D.CAPITOL = 1186 AND  D.RIND IN ('654') THEN  D.COL1 ELSE NULL END ) AS  R_654_COL1,
       SUM(CASE WHEN D.CAPITOL = 1186 AND  D.RIND IN ('654') THEN  D.COL2 ELSE NULL END ) AS  R_654_COL2,
       
       
                        SUM(CASE WHEN D.CAPITOL = 1186 AND  D.RIND IN ('660') THEN  D.COL1 ELSE NULL END ) AS  R_660_COL1,
       SUM(CASE WHEN D.CAPITOL = 1186 AND  D.RIND IN ('660') THEN  D.COL2 ELSE NULL END ) AS  R_660_COL2,
       
       SUM(CASE WHEN D.CAPITOL = 1186 AND  D.RIND IN ('681') THEN  D.COL1 ELSE NULL END ) AS  R_681_COL1,
       SUM(CASE WHEN D.CAPITOL = 1186 AND  D.RIND IN ('681') THEN  D.COL2 ELSE NULL END ) AS  R_681_COL2,
       
       
         SUM(CASE WHEN D.CAPITOL = 1186 AND  D.RIND IN ('682') THEN  D.COL1 ELSE NULL END ) AS  R_682_COL1,
         SUM(CASE WHEN D.CAPITOL = 1186 AND  D.RIND IN ('682') THEN  D.COL2 ELSE NULL END ) AS  R_682_COL2,
       
    SUM(CASE WHEN D.CAPITOL = 1186 AND  D.RIND IN ('683') THEN  D.COL1 ELSE NULL END ) AS  R_683_COL1,
         SUM(CASE WHEN D.CAPITOL = 1186 AND  D.RIND IN ('683') THEN  D.COL2 ELSE NULL END ) AS  R_683_COL2,
         
 SUM(CASE WHEN D.CAPITOL = 1186 AND  D.RIND IN ('684') THEN  D.COL1 ELSE NULL END ) AS  R_684_COL1,
         SUM(CASE WHEN D.CAPITOL = 1186 AND  D.RIND IN ('684') THEN  D.COL2 ELSE NULL END ) AS  R_684_COL2,
         
          SUM(CASE WHEN D.CAPITOL = 1187 AND  D.RIND IN ('710') THEN  D.COL1 ELSE NULL END ) AS  R_710_COL1,
         SUM(CASE WHEN D.CAPITOL = 1187 AND  D.RIND IN ('710') THEN  D.COL2 ELSE NULL END ) AS  R_710_COL2,
         
             SUM(CASE WHEN D.CAPITOL = 1187 AND  D.RIND IN ('721') THEN  D.COL1 ELSE NULL END ) AS  R_721_COL1,
         SUM(CASE WHEN D.CAPITOL = 1187 AND  D.RIND IN ('721') THEN  D.COL2 ELSE NULL END ) AS  R_721_COL2,
         
         SUM(CASE WHEN D.CAPITOL = 1187 AND  D.RIND IN ('722') THEN  D.COL1 ELSE NULL END ) AS  R_722_COL1,
         SUM(CASE WHEN D.CAPITOL = 1187 AND  D.RIND IN ('722') THEN  D.COL2 ELSE NULL END ) AS  R_722_COL2,
         SUM(CASE WHEN D.CAPITOL = 1187 AND  D.RIND IN ('900') THEN  D.COL1 ELSE NULL END ) AS  R_900_COL1
         
              
    
       
       
                FROM CIS2.VW_DATA_ALL D
                            INNER JOIN CIS2.RENIM R ON R.CUIIO = D.CUIIO
                                                   AND R.CUIIO_VERS = D.CUIIO_VERS 
                                                   
                                                   INNER JOIN CIS2.CL_CUATM74 C4 ON D.CUATM = C4.CODUL7
                                                   
                                                   INNER JOIN CIS2.VW_CL_CUATM C ON C.CODUL = D.CUATM
                
                WHERE 
                1=1
                AND D.FORM IN (:pFORM)
                AND D.PERIOADA IN (:pPERIOADA) 
                
                
                GROUP BY
                R.CUATM,
                C4.CODUL4,
                D.CUIIO,
                R.IDNO,
                R.CAEM2,
                R.DENUMIRE,
                C.FULL_CODE
                
                ORDER BY 
                C.FULL_CODE