INSERT INTO CIS2.TABLE_OUT 
(
  PERIOADA,
  FORM,
  FORM_VERS,
  ID_MDTABLE,
  COD_CUATM,
  NR_SECTIE,
  NUME_SECTIE,
  NR_SECTIE1,
  NUME_SECTIE1,
  NR_SECTIE2,
  NUME_SECTIE2,
  NR_ROW,
  ORDINE,
  DECIMAL_POS,
  NUME_ROW,  
  COL1,COL2, COL3
)


SELECT
  :pPERIOADA AS PERIOADA,
  :pFORM AS FORM,
  :pFORM_VERS AS FORM_VERS,
  :pID_MDTABLE AS ID_MDTABLE,
  :pCOD_CUATM AS COD_CUATM,
         
  '0' AS  NR_SECTIE,
  '0' AS  NUME_SECTIE,
  '0' AS NR_SECTIE1,
  '0' AS NUME_SECTIE1,
  '0' as NR_SECTIE2,
  '0' as NUME_SECTIE2,
    NR_ROW AS NR_ROW,
  ordine as  ORDINE,
  '0000000' AS DECIMAL_POS,
  NUME_ROW AS NUME_ROW,
  COL1,COL2, COL3
FROM
(

---------------------------------TOTAL------------------

SELECT
  :pPERIOADA AS PERIOADA,
  :pFORM AS FORM,
  :pFORM_VERS AS FORM_VERS,
  :pID_MDTABLE AS ID_MDTABLE,
  :pCOD_CUATM AS COD_CUATM,
         
  '0' AS  NR_SECTIE,
  '0' AS  NUME_SECTIE,
  '0' AS NR_SECTIE1,
  '0' AS NUME_SECTIE1,
  '0' as NR_SECTIE2,
  '0' as NUME_SECTIE2,
  NR_ROW AS NR_ROW,
  1 ORDINE,
  '00000000' AS DECIMAL_POS,
  NUME_ROW AS NUME_ROW,COL1,COL2, COL3
  
  FROM (
  SELECT 
  NR_ROW,  
  NUME_ROW,
  SUM(COL5) AS COL1, SUM(COL6) AS COL2,ROUND((SUM(COL6)/CIS2.NOZERO(SUM(COL5)))*100,1) AS COL3
FROM
(
SELECT 
D.CUIIO,
  '01' AS NR_ROW,
  'TOTAL 'AS NUME_ROW,
  CIS2.NVAL(COUNT( DISTINCT CASE WHEN D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2') AND D.COL1=1 THEN D.CUIIO END )) AS COL1,
  100 AS COL2,
  CIS2.NVAL(COUNT( DISTINCT CASE WHEN D.CAPITOL||'.'||D.RIND IN ('1042.3.1.1','1042.3.1.2','1042.3.1.3') AND D.COL1=1 THEN D.CUIIO END )) AS COL3,
  100 AS COL4,
 CIS2.NVAL(MAX(CASE WHEN D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5,
  CIS2.NVAL(MAX(CASE WHEN D.CAPITOL||'.'||D.RIND IN ('1041.2.2.1','1041.2.2.2','1042.3.2.1','1042.3.2.2') AND D.COL1=1 THEN D.COL1 ELSE NULL END)) AS COL6

  
  FROM 
  CIS2.VW_DATA_ALL D    
  INNER JOIN CIS2.VW_CL_CAEM2 CC ON (D.CAEM2=CC.CODUL AND CC.FULL_CODE LIKE '%'||D.CAEM2||';%')
    

WHERE
  D.PERIOADA IN (:pPERIOADA) AND 
  D.FORM_VERS = :pFORM_VERS     AND   
  D.FORM= :pFORM     AND    
  (:pID_MDTABLE=:pID_MDTABLE) AND
  D.CUATM_FULL LIKE '%'||:pCOD_CUATM||';%' AND
  D.FORM IN (48)  
 -- AND
-- (D.CAEM2  BETWEEN 'B0000000' AND  'M7320' )
   GROUP BY D.CUIIO

  )
  
  GROUP BY NR_ROW, NUME_ROW)
  
  
  
  UNION

---------------------------------INDUSTRIE-----------------
SELECT
  :pPERIOADA AS PERIOADA,
  :pFORM AS FORM,
  :pFORM_VERS AS FORM_VERS,
  :pID_MDTABLE AS ID_MDTABLE,
  :pCOD_CUATM AS COD_CUATM,
         
  '0' AS  NR_SECTIE,
  '0' AS  NUME_SECTIE,
  '0' AS NR_SECTIE1,
  '0' AS NUME_SECTIE1,
  '0' as NR_SECTIE2,
  '0' as NUME_SECTIE2,
  NR_ROW AS NR_ROW,
  2 ORDINE,
  '00000000' AS DECIMAL_POS,
   NUME_ROW AS NUME_ROW,COL1,COL2, COL3
  
  FROM (
  SELECT 
  NR_ROW,  
  NUME_ROW,
  SUM(COL5) AS COL1, SUM(COL6) AS COL2,ROUND((SUM(COL6)/CIS2.NOZERO(SUM(COL5)))*100,1) AS COL3
FROM
(
SELECT 
D.CUIIO,
  '02' AS NR_ROW,
  'Industie Totala 'AS NUME_ROW,
  CIS2.NVAL(COUNT( DISTINCT CASE WHEN D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2') AND D.COL1=1 THEN D.CUIIO END )) AS COL1,
  100 AS COL2,
  CIS2.NVAL(COUNT( DISTINCT CASE WHEN D.CAPITOL||'.'||D.RIND IN ('1042.3.1.1','1042.3.1.2','1042.3.1.3') AND D.COL1=1 THEN D.CUIIO END )) AS COL3,
  100 AS COL4,
 CIS2.NVAL(MAX(CASE WHEN D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5,
  CIS2.NVAL(MAX(CASE WHEN D.CAPITOL||'.'||D.RIND IN ('1041.2.2.1','1041.2.2.2','1042.3.2.1','1042.3.2.2') AND D.COL1=1 THEN D.COL1 ELSE NULL END)) AS COL6

  FROM 
  CIS2.VW_DATA_ALL D    
  INNER JOIN CIS2.VW_CL_CAEM2 CC ON (D.CAEM2=CC.CODUL AND CC.FULL_CODE LIKE '%'||D.CAEM2||';%')


WHERE
  D.PERIOADA IN (:pPERIOADA) AND 
  D.FORM_VERS = :pFORM_VERS     AND   
  D.FORM= :pFORM     AND    
  (:pID_MDTABLE=:pID_MDTABLE) AND
  D.CUATM_FULL LIKE '%'||:pCOD_CUATM||';%' AND
  D.FORM IN (48)  AND
  D.CAEM2 BETWEEN 'B0000000' AND 'E3900' 
  
  GROUP BY D.CUIIO

  )
  
  GROUP BY NR_ROW, NUME_ROW)
  
  
--------------------------------
UNION

SELECT
  :pPERIOADA AS PERIOADA,
  :pFORM AS FORM,
  :pFORM_VERS AS FORM_VERS,
  :pID_MDTABLE AS ID_MDTABLE,
  :pCOD_CUATM AS COD_CUATM,
         
  '0' AS  NR_SECTIE,
  '0' AS  NUME_SECTIE,
  '0' AS NR_SECTIE1,
  '0' AS NUME_SECTIE1,
  '0' as NR_SECTIE2,
  '0' as NUME_SECTIE2,
  NR_ROW AS NR_ROW,
  3 ORDINE,
  '00000000' AS DECIMAL_POS,
 NUME_ROW AS NUME_ROW,COL1,COL2, COL3
  
  FROM (
  SELECT 
  NR_ROW,  
  NUME_ROW,
  SUM(COL5) AS COL1, SUM(COL6) AS COL2,ROUND((SUM(COL6)/CIS2.NOZERO(SUM(COL5)))*100,1) AS COL3 FROM
(
SELECT 
D.CUIIO,
  '03' AS NR_ROW,
  'Industrie extractiva -B (05-09)  'AS NUME_ROW,
  CIS2.NVAL(COUNT( DISTINCT CASE WHEN D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2') AND D.COL1=1 THEN D.CUIIO END )) AS COL1,
  100 AS COL2,
  CIS2.NVAL(COUNT( DISTINCT CASE WHEN D.CAPITOL||'.'||D.RIND IN ('1042.3.1.1','1042.3.1.2','1042.3.1.3') AND D.COL1=1 THEN D.CUIIO END )) AS COL3,
  100 AS COL4,
 CIS2.NVAL(MAX(CASE WHEN D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5,
  CIS2.NVAL(MAX(CASE WHEN D.CAPITOL||'.'||D.RIND IN ('1041.2.2.1','1041.2.2.2','1042.3.2.1','1042.3.2.2') AND D.COL1=1 THEN D.COL1 ELSE NULL END)) AS COL6
FROM 
  CIS2.VW_DATA_ALL D    

WHERE
  D.PERIOADA IN (:pPERIOADA) AND 
  D.FORM_VERS = :pFORM_VERS     AND   
  D.FORM= :pFORM     AND    
  (:pID_MDTABLE=:pID_MDTABLE) AND
  D.CUATM_FULL LIKE '%'||:pCOD_CUATM||';%' AND
  D.FORM IN (48)  AND
  D.CAEM2 LIKE 'B%' 
  
  GROUP BY D.CUIIO

  )
  
  GROUP BY NR_ROW, NUME_ROW)
  
--------------------------------  
  UNION
  
  SELECT
  :pPERIOADA AS PERIOADA,
  :pFORM AS FORM,
  :pFORM_VERS AS FORM_VERS,
  :pID_MDTABLE AS ID_MDTABLE,
  :pCOD_CUATM AS COD_CUATM,
         
  '0' AS  NR_SECTIE,
  '0' AS  NUME_SECTIE,
  '0' AS NR_SECTIE1,
  '0' AS NUME_SECTIE1,
  '0' as NR_SECTIE2,
  '0' as NUME_SECTIE2,
  NR_ROW AS NR_ROW,
  4 ORDINE,
    '00000000' AS DECIMAL_POS,
  NUME_ROW AS NUME_ROW,COL1,COL2, COL3
  
  FROM (
  SELECT 
  NR_ROW,  
  NUME_ROW,
  SUM(COL5) AS COL1, SUM(COL6) AS COL2,ROUND((SUM(COL6)/CIS2.NOZERO(SUM(COL5)))*100,1) AS COL3
FROM
(
SELECT 
D.CUIIO,
  '04' AS NR_ROW,
  'Industrie prelucratoare - C (10-33)  'AS NUME_ROW,
  CIS2.NVAL(COUNT( DISTINCT CASE WHEN D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2') AND D.COL1=1 THEN D.CUIIO END )) AS COL1,
  100 AS COL2,
  CIS2.NVAL(COUNT( DISTINCT CASE WHEN D.CAPITOL||'.'||D.RIND IN ('1042.3.1.1','1042.3.1.2','1042.3.1.3') AND D.COL1=1 THEN D.CUIIO END )) AS COL3,
  100 AS COL4,
 CIS2.NVAL(MAX(CASE WHEN D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5,
  CIS2.NVAL(MAX(CASE WHEN D.CAPITOL||'.'||D.RIND IN ('1041.2.2.1','1041.2.2.2','1042.3.2.1','1042.3.2.2') AND D.COL1=1 THEN D.COL1 ELSE NULL END)) AS COL6
FROM 
  CIS2.VW_DATA_ALL D    

WHERE
  D.PERIOADA IN (:pPERIOADA) AND 
  D.FORM_VERS = :pFORM_VERS     AND   
  D.FORM= :pFORM     AND    
  (:pID_MDTABLE=:pID_MDTABLE) AND
  D.CUATM_FULL LIKE '%'||:pCOD_CUATM||';%' AND
  D.FORM IN (48)  AND
  D.CAEM2 LIKE 'C%'  GROUP BY D.CUIIO

  )
  
  GROUP BY NR_ROW, NUME_ROW)
  
  
--------------------------------    
  UNION
  
  SELECT
  :pPERIOADA AS PERIOADA,
  :pFORM AS FORM,
  :pFORM_VERS AS FORM_VERS,
  :pID_MDTABLE AS ID_MDTABLE,
  :pCOD_CUATM AS COD_CUATM,
         
  '0' AS  NR_SECTIE,
  '0' AS  NUME_SECTIE,
  '0' AS NR_SECTIE1,
  '0' AS NUME_SECTIE1,
  '0' as NR_SECTIE2,
  '0' as NUME_SECTIE2,
  NR_ROW AS NR_ROW,
  5 ORDINE,
  '00000000' AS DECIMAL_POS,
  NUME_ROW AS NUME_ROW,COL1,COL2, COL3
  
  FROM (
  SELECT 
  NR_ROW,  
  NUME_ROW,
  SUM(COL5) AS COL1, SUM(COL6) AS COL2,ROUND((SUM(COL6)/CIS2.NOZERO(SUM(COL5)))*100,1) AS COL3
FROM
(
SELECT 
D.CUIIO,
  '05' AS NR_ROW,
  'Produc?ia ?i furnizarea de energie electrica ?i termica, gaze, apa calda ?i aer condi?ionat - D (35)  'AS NUME_ROW,
  CIS2.NVAL(COUNT( DISTINCT CASE WHEN D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2') AND D.COL1=1 THEN D.CUIIO END )) AS COL1,
  100 AS COL2,
  CIS2.NVAL(COUNT( DISTINCT CASE WHEN D.CAPITOL||'.'||D.RIND IN ('1042.3.1.1','1042.3.1.2','1042.3.1.3') AND D.COL1=1 THEN D.CUIIO END )) AS COL3,
  100 AS COL4,
 CIS2.NVAL(MAX(CASE WHEN D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5,
  CIS2.NVAL(MAX(CASE WHEN D.CAPITOL||'.'||D.RIND IN ('1041.2.2.1','1041.2.2.2','1042.3.2.1','1042.3.2.2') AND D.COL1=1 THEN D.COL1 ELSE NULL END)) AS COL6
  
  FROM 
  CIS2.VW_DATA_ALL D        
WHERE
  D.PERIOADA IN (:pPERIOADA) AND 
  D.FORM_VERS = :pFORM_VERS     AND   
  D.FORM= :pFORM     AND    
  (:pID_MDTABLE=:pID_MDTABLE) AND
  D.CUATM_FULL LIKE '%'||:pCOD_CUATM||';%' AND
  D.FORM IN (48)  AND
  D.CAEM2 LIKE 'D35%'   
  
  GROUP BY D.CUIIO

  )
  
  GROUP BY NR_ROW, NUME_ROW)
  

 --------------------------------   
  UNION
  
  SELECT
  :pPERIOADA AS PERIOADA,
  :pFORM AS FORM,
  :pFORM_VERS AS FORM_VERS,
  :pID_MDTABLE AS ID_MDTABLE,
  :pCOD_CUATM AS COD_CUATM,
         
  '0' AS  NR_SECTIE,
  '0' AS  NUME_SECTIE,
  '0' AS NR_SECTIE1,
  '0' AS NUME_SECTIE1,
  '0' as NR_SECTIE2,
  '0' as NUME_SECTIE2,
  NR_ROW AS NR_ROW,
  6 ORDINE,
  '00000000' AS DECIMAL_POS,
  NUME_ROW AS NUME_ROW,COL1,COL2, COL3
  
  FROM (
  SELECT 
  NR_ROW,  
  NUME_ROW,
  SUM(COL5) AS COL1, SUM(COL6) AS COL2,ROUND((SUM(COL6)/CIS2.NOZERO(SUM(COL5)))*100,1) AS COL3
FROM
(
SELECT 
D.CUIIO,
  '06' AS NR_ROW,
  'Produc?ia ?i furnizarea de energie electrica ?i termica, gaze, apa calda ?i aer condi?ionat - D (35) 'AS NUME_ROW,
  CIS2.NVAL(COUNT( DISTINCT CASE WHEN D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2') AND D.COL1=1 THEN D.CUIIO END )) AS COL1,
  100 AS COL2,
  CIS2.NVAL(COUNT( DISTINCT CASE WHEN D.CAPITOL||'.'||D.RIND IN ('1042.3.1.1','1042.3.1.2','1042.3.1.3') AND D.COL1=1 THEN D.CUIIO END )) AS COL3,
  100 AS COL4,
 CIS2.NVAL(MAX(CASE WHEN D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5,
  CIS2.NVAL(MAX(CASE WHEN D.CAPITOL||'.'||D.RIND IN ('1041.2.2.1','1041.2.2.2','1042.3.2.1','1042.3.2.2') AND D.COL1=1 THEN D.COL1 ELSE NULL END)) AS COL6
  

  FROM 
  CIS2.VW_DATA_ALL D   

WHERE
  D.PERIOADA IN (:pPERIOADA) AND 
  D.FORM_VERS = :pFORM_VERS     AND   
  D.FORM= :pFORM     AND    
  (:pID_MDTABLE=:pID_MDTABLE) AND
  D.CUATM_FULL LIKE '%'||:pCOD_CUATM||';%' AND
  D.FORM IN (48)  AND
  D.CAEM2 LIKE 'E%'  GROUP BY D.CUIIO

  )
  
  GROUP BY NR_ROW, NUME_ROW)
  
------------------------------------------SERVICII---------------------------
UNION
SELECT
  :pPERIOADA AS PERIOADA,
  :pFORM AS FORM,
  :pFORM_VERS AS FORM_VERS,
  :pID_MDTABLE AS ID_MDTABLE,
  :pCOD_CUATM AS COD_CUATM,
         
  '0' AS  NR_SECTIE,
  '0' AS  NUME_SECTIE,
  '0' AS NR_SECTIE1,
  '0' AS NUME_SECTIE1,
  '0' as NR_SECTIE2,
  '0' as NUME_SECTIE2,
  NR_ROW AS NR_ROW,
  7 ORDINE,

  '00000000' AS DECIMAL_POS,
  NUME_ROW AS NUME_ROW,COL1,COL2, COL3
  
  FROM (
  SELECT 
  NR_ROW,  
  NUME_ROW,
  SUM(COL5) AS COL1, SUM(COL6) AS COL2,ROUND((SUM(COL6)/CIS2.NOZERO(SUM(COL5)))*100,1) AS COL3
FROM
(
SELECT 
D.CUIIO,
  '07' AS NR_ROW,
  'SERVICII - total 'AS NUME_ROW,
  CIS2.NVAL(COUNT( DISTINCT CASE WHEN D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2') AND D.COL1=1 THEN D.CUIIO END )) AS COL1,
  100 AS COL2,
  CIS2.NVAL(COUNT( DISTINCT CASE WHEN D.CAPITOL||'.'||D.RIND IN ('1042.3.1.1','1042.3.1.2','1042.3.1.3') AND D.COL1=1 THEN D.CUIIO END )) AS COL3,
  100 AS COL4,
 CIS2.NVAL(MAX(CASE WHEN D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5,
  CIS2.NVAL(MAX(CASE WHEN D.CAPITOL||'.'||D.RIND IN ('1041.2.2.1','1041.2.2.2','1042.3.2.1','1042.3.2.2') AND D.COL1=1 THEN D.COL1 ELSE NULL END)) AS COL6
  
  FROM 
  CIS2.VW_DATA_ALL D 

WHERE
  D.PERIOADA IN (:pPERIOADA) AND 
  D.FORM_VERS = :pFORM_VERS     AND   
  D.FORM= :pFORM     AND    
  (:pID_MDTABLE=:pID_MDTABLE) AND
  D.CUATM_FULL LIKE '%'||:pCOD_CUATM||';%' AND
  D.FORM IN (48)  AND
   D.CAEM2 BETWEEN 'G46000'  AND 'M7320'  
  
  GROUP BY D.CUIIO

  )
  
  GROUP BY NR_ROW, NUME_ROW)
  
--------------------------------
UNION
SELECT
  :pPERIOADA AS PERIOADA,
  :pFORM AS FORM,
  :pFORM_VERS AS FORM_VERS,
  :pID_MDTABLE AS ID_MDTABLE,
  :pCOD_CUATM AS COD_CUATM,
         
  '0' AS  NR_SECTIE,
  '0' AS  NUME_SECTIE,
  '0' AS NR_SECTIE1,
  '0' AS NUME_SECTIE1,
  '0' as NR_SECTIE2,
  '0' as NUME_SECTIE2,
  NR_ROW AS NR_ROW,
  8 ORDINE,

  '00000000' AS DECIMAL_POS,
  NUME_ROW AS NUME_ROW,COL1,COL2, COL3
  
  FROM (
  SELECT 
  NR_ROW,  
  NUME_ROW,
  SUM(COL5) AS COL1, SUM(COL6) AS COL2,ROUND((SUM(COL6)/CIS2.NOZERO(SUM(COL5)))*100,1) AS COL3
FROM
(
SELECT 
D.CUIIO,
  '08' AS NR_ROW,
  'Come? cu ridicata - G (46) 'AS NUME_ROW,
  CIS2.NVAL(COUNT( DISTINCT CASE WHEN D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2') AND D.COL1=1 THEN D.CUIIO END )) AS COL1,
  100 AS COL2,
  CIS2.NVAL(COUNT( DISTINCT CASE WHEN D.CAPITOL||'.'||D.RIND IN ('1042.3.1.1','1042.3.1.2','1042.3.1.3') AND D.COL1=1 THEN D.CUIIO END )) AS COL3,
  100 AS COL4,
 CIS2.NVAL(MAX(CASE WHEN D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5,
  CIS2.NVAL(MAX(CASE WHEN D.CAPITOL||'.'||D.RIND IN ('1041.2.2.1','1041.2.2.2','1042.3.2.1','1042.3.2.2') AND D.COL1=1 THEN D.COL1 ELSE NULL END)) AS COL6
  
  FROM 
  CIS2.VW_DATA_ALL D 

WHERE
  D.PERIOADA IN (:pPERIOADA) AND 
  D.FORM_VERS = :pFORM_VERS     AND   
  D.FORM= :pFORM     AND    
  (:pID_MDTABLE=:pID_MDTABLE) AND
  D.CUATM_FULL LIKE '%'||:pCOD_CUATM||';%' AND
  D.FORM IN (48)  AND
  D.CAEM2 LIKE 'G46%'   
  
  GROUP BY D.CUIIO

  )
  
  GROUP BY NR_ROW, NUME_ROW)
  
--------------------------------  
  UNION
  
  SELECT
  :pPERIOADA AS PERIOADA,
  :pFORM AS FORM,
  :pFORM_VERS AS FORM_VERS,
  :pID_MDTABLE AS ID_MDTABLE,
  :pCOD_CUATM AS COD_CUATM,
         
  '0' AS  NR_SECTIE,
  '0' AS  NUME_SECTIE,
  '0' AS NR_SECTIE1,
  '0' AS NUME_SECTIE1,
  '0' as NR_SECTIE2,
  '0' as NUME_SECTIE2,
  NR_ROW AS NR_ROW,
  9 ORDINE,

  '00000000' AS DECIMAL_POS,
  NUME_ROW AS NUME_ROW,COL1,COL2, COL3
  
  FROM (
  SELECT 
  NR_ROW,  
  NUME_ROW,
  SUM(COL5) AS COL1, SUM(COL6) AS COL2,ROUND((SUM(COL6)/CIS2.NOZERO(SUM(COL5)))*100,1) AS COL3
FROM
(
SELECT 
D.CUIIO,
  '09' AS NR_ROW,
  'Transport ?i depozitare - H (49-53) 'AS NUME_ROW,
  CIS2.NVAL(COUNT( DISTINCT CASE WHEN D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2') AND D.COL1=1 THEN D.CUIIO END )) AS COL1,
  100 AS COL2,
  CIS2.NVAL(COUNT( DISTINCT CASE WHEN D.CAPITOL||'.'||D.RIND IN ('1042.3.1.1','1042.3.1.2','1042.3.1.3') AND D.COL1=1 THEN D.CUIIO END )) AS COL3,
  100 AS COL4,
 CIS2.NVAL(MAX(CASE WHEN D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5,
  CIS2.NVAL(MAX(CASE WHEN D.CAPITOL||'.'||D.RIND IN ('1041.2.2.1','1041.2.2.2','1042.3.2.1','1042.3.2.2') AND D.COL1=1 THEN D.COL1 ELSE NULL END)) AS COL6
  
  FROM 
  CIS2.VW_DATA_ALL D 

WHERE
  D.PERIOADA IN (:pPERIOADA) AND 
  D.FORM_VERS = :pFORM_VERS     AND   
  D.FORM= :pFORM     AND    
  (:pID_MDTABLE=:pID_MDTABLE) AND
  D.CUATM_FULL LIKE '%'||:pCOD_CUATM||';%' AND
  D.FORM IN (48)  AND
  D.CAEM2 LIKE 'H%'   GROUP BY D.CUIIO

  )
  
  GROUP BY NR_ROW, NUME_ROW)
  
  
--------------------------------    
  UNION
  
  SELECT
  :pPERIOADA AS PERIOADA,
  :pFORM AS FORM,
  :pFORM_VERS AS FORM_VERS,
  :pID_MDTABLE AS ID_MDTABLE,
  :pCOD_CUATM AS COD_CUATM,
         
  '0' AS  NR_SECTIE,
  '0' AS  NUME_SECTIE,
  '0' AS NR_SECTIE1,
  '0' AS NUME_SECTIE1,
  '0' as NR_SECTIE2,
  '0' as NUME_SECTIE2,
  NR_ROW AS NR_ROW,
  10 as  ORDINE,

  '00000000' AS DECIMAL_POS,
  NUME_ROW AS NUME_ROW,COL1,COL2, COL3
  
  FROM (
  SELECT 
  NR_ROW,  
  NUME_ROW,
  SUM(COL5) AS COL1, SUM(COL6) AS COL2,ROUND((SUM(COL6)/CIS2.NOZERO(SUM(COL5)))*100,1) AS COL3
FROM
(
SELECT 
D.CUIIO,
  '10' AS NR_ROW,
  'Informa?ii ?i comunica?ii - J (58-63)  'AS NUME_ROW,
  CIS2.NVAL(COUNT( DISTINCT CASE WHEN D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2') AND D.COL1=1 THEN D.CUIIO END )) AS COL1,
  100 AS COL2,
  CIS2.NVAL(COUNT( DISTINCT CASE WHEN D.CAPITOL||'.'||D.RIND IN ('1042.3.1.1','1042.3.1.2','1042.3.1.3') AND D.COL1=1 THEN D.CUIIO END )) AS COL3,
  100 AS COL4,
 CIS2.NVAL(MAX(CASE WHEN D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5,
  CIS2.NVAL(MAX(CASE WHEN D.CAPITOL||'.'||D.RIND IN ('1041.2.2.1','1041.2.2.2','1042.3.2.1','1042.3.2.2') AND D.COL1=1 THEN D.COL1 ELSE NULL END)) AS COL6
  
  FROM 
  CIS2.VW_DATA_ALL D 

WHERE
  D.PERIOADA IN (:pPERIOADA) AND 
  D.FORM_VERS = :pFORM_VERS     AND   
  D.FORM= :pFORM     AND    
  (:pID_MDTABLE=:pID_MDTABLE) AND
  D.CUATM_FULL LIKE '%'||:pCOD_CUATM||';%' AND
  D.FORM IN (48)  AND
  D.CAEM2 LIKE 'J%'   GROUP BY D.CUIIO

  )
  
  GROUP BY NR_ROW, NUME_ROW)
  

 --------------------------------   
  UNION
  
  SELECT
  :pPERIOADA AS PERIOADA,
  :pFORM AS FORM,
  :pFORM_VERS AS FORM_VERS,
  :pID_MDTABLE AS ID_MDTABLE,
  :pCOD_CUATM AS COD_CUATM,
         
  '0' AS  NR_SECTIE,
  '0' AS  NUME_SECTIE,
  '0' AS NR_SECTIE1,
  '0' AS NUME_SECTIE1,
  '0' as NR_SECTIE2,
  '0' as NUME_SECTIE2,
  NR_ROW AS NR_ROW,
  11 as  ORDINE,

  '00000000' AS DECIMAL_POS,
  NUME_ROW AS NUME_ROW,COL1,COL2, COL3
  
  FROM (
  SELECT 
  NR_ROW,  
  NUME_ROW,
  SUM(COL5) AS COL1, SUM(COL6) AS COL2,ROUND((SUM(COL6)/CIS2.NOZERO(SUM(COL5)))*100,1) AS COL3
FROM
(
SELECT 
D.CUIIO,
  '11' AS NR_ROW,
  'Intermedieri financiare ?i asigurari - K (64-66) 'AS NUME_ROW,
  CIS2.NVAL(COUNT( DISTINCT CASE WHEN D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2') AND D.COL1=1 THEN D.CUIIO END )) AS COL1,
  100 AS COL2,
  CIS2.NVAL(COUNT( DISTINCT CASE WHEN D.CAPITOL||'.'||D.RIND IN ('1042.3.1.1','1042.3.1.2','1042.3.1.3') AND D.COL1=1 THEN D.CUIIO END )) AS COL3,
  100 AS COL4,
 CIS2.NVAL(MAX(CASE WHEN D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5,
  CIS2.NVAL(MAX(CASE WHEN D.CAPITOL||'.'||D.RIND IN ('1041.2.2.1','1041.2.2.2','1042.3.2.1','1042.3.2.2') AND D.COL1=1 THEN D.COL1 ELSE NULL END)) AS COL6
  
  FROM 
  CIS2.VW_DATA_ALL D 

WHERE
  D.PERIOADA IN (:pPERIOADA) AND 
  D.FORM_VERS = :pFORM_VERS     AND   
  D.FORM= :pFORM     AND    
  (:pID_MDTABLE=:pID_MDTABLE) AND
  D.CUATM_FULL LIKE '%'||:pCOD_CUATM||';%' AND
  D.FORM IN (48)  AND
  D.CAEM2 LIKE 'K%'   GROUP BY D.CUIIO

  )
  
  GROUP BY NR_ROW, NUME_ROW)
  
  
    UNION
  
  SELECT
  :pPERIOADA AS PERIOADA,
  :pFORM AS FORM,
  :pFORM_VERS AS FORM_VERS,
  :pID_MDTABLE AS ID_MDTABLE,
  :pCOD_CUATM AS COD_CUATM,
         
  '0' AS  NR_SECTIE,
  '0' AS  NUME_SECTIE,
  '0' AS NR_SECTIE1,
  '0' AS NUME_SECTIE1,
  '0' as NR_SECTIE2,
  '0' as NUME_SECTIE2,
  NR_ROW AS NR_ROW,
  12 ORDINE,
  '00000000' AS DECIMAL_POS,
  NUME_ROW AS NUME_ROW,COL1,COL2, COL3
  
  FROM (
  SELECT 
  NR_ROW,  
  NUME_ROW,
  SUM(COL5) AS COL1, SUM(COL6) AS COL2,ROUND((SUM(COL6)/CIS2.NOZERO(SUM(COL5)))*100,1) AS COL3
FROM
(
SELECT 
D.CUIIO,
  '12' AS NR_ROW,
  'Activita?i profesionale, ?tiin?ifice ?i tehnice - M (71-73) 'AS NUME_ROW,
  CIS2.NVAL(COUNT( DISTINCT CASE WHEN D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2') AND D.COL1=1 THEN D.CUIIO END )) AS COL1,
  100 AS COL2,
  CIS2.NVAL(COUNT( DISTINCT CASE WHEN D.CAPITOL||'.'||D.RIND IN ('1042.3.1.1','1042.3.1.2','1042.3.1.3') AND D.COL1=1 THEN D.CUIIO END )) AS COL3,
  100 AS COL4,
 CIS2.NVAL(MAX(CASE WHEN D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5,
  CIS2.NVAL(MAX(CASE WHEN D.CAPITOL||'.'||D.RIND IN ('1041.2.2.1','1041.2.2.2','1042.3.2.1','1042.3.2.2') AND D.COL1=1 THEN D.COL1 ELSE NULL END)) AS COL6
  
  FROM 
  CIS2.VW_DATA_ALL D 

WHERE
  D.PERIOADA IN (:pPERIOADA) AND 
  D.FORM_VERS = :pFORM_VERS     AND   
  D.FORM= :pFORM     AND    
  (:pID_MDTABLE=:pID_MDTABLE) AND
  D.CUATM_FULL LIKE '%'||:pCOD_CUATM||';%' AND
  D.FORM IN (48)  AND
  D.CAEM2 LIKE 'M%' 
   GROUP BY D.CUIIO

  )
  
  GROUP BY NR_ROW, NUME_ROW
  
  )
  
  )