SELECT 
CODUL,
SUM(COL1) AS COL1,
SUM(COL2) AS COL2,
SUM(COL3) AS COL3,
SUM(COL4) AS COL4,
SUM(COL5) AS COL5,
SUM(COL6) AS COL6,
SUM(COL7) AS COL7,
SUM(COL8) AS COL8,
SUM(COL9) AS COL9,
SUM(COL10) AS COL10,

SUM(COL11) AS COL11,
SUM(COL12) AS COL12,
SUM(COL13) AS COL13,
SUM(COL14) AS COL14,
SUM(COL15) AS COL15,
SUM(COL16) AS COL16,
SUM(COL17) AS COL17,
SUM(COL18) AS COL18,
SUM(COL19) AS COL19,
SUM(COL20) AS COL20,

SUM(COL21) AS COL21,
SUM(COL22) AS COL22,
SUM(COL23) AS COL23,
SUM(COL24) AS COL24,
SUM(COL25) AS COL25,
SUM(COL26) AS COL26,
SUM(COL27) AS COL27,
SUM(COL28) AS COL28,
SUM(COL29) AS COL29,
SUM(COL30) AS COL30,


SUM(COL31) AS COL31,
SUM(COL32) AS COL32,
SUM(COL33) AS COL33,
SUM(COL34) AS COL34,
SUM(COL35) AS COL35,
SUM(COL36) AS COL36,
SUM(COL37) AS COL37,
SUM(COL38) AS COL38,
SUM(COL39) AS COL39,
SUM(COL40) AS COL40,

SUM(COL41) AS COL41,
SUM(COL42) AS COL42,
SUM(COL43) AS COL43,
SUM(COL44) AS COL44,
SUM(COL45) AS COL45,
SUM(COL46) AS COL46,
SUM(COL47) AS COL47,
SUM(COL48) AS COL48,
SUM(COL49) AS COL49,
SUM(COL50) AS COL50,

SUM(COL51) AS COL51,
SUM(COL52) AS COL52,
SUM(COL53) AS COL53,
SUM(COL54) AS COL54,
SUM(COL55) AS COL55,
SUM(COL56) AS COL56,
SUM(COL57) AS COL57,
SUM(COL58) AS COL58,
SUM(COL59) AS COL59,
SUM(COL60) AS COL60


FROM 

(
SELECT    
           
           C.CODUL,
           COUNT(DISTINCT CASE WHEN C.CODUL = R.CAEM2 AND CC.FULL_CODE LIKE '%'||'0000000'||';%' THEN FC.CUIIO END ) AS COL1,
           NULL AS COL2,
           NULL AS COL3,
           NULL AS COL4,
           NULL AS COL5,
           NULL AS COL6,
           NULL AS COL7,
           NULL AS COL8,
           NULL AS COL9,
           NULL AS COL10,
           
           COUNT(DISTINCT CASE WHEN C.CODUL = R.CAEM2 AND CC.FULL_CODE LIKE '%'||'1111111'||';%' THEN FC.CUIIO END ) AS COL11,
           NULL AS COL12,
           NULL AS COL13,
           NULL AS COL14,
           NULL AS COL15,
           NULL AS COL16,
           NULL AS COL17,
           NULL AS COL18,
           NULL AS COL19,
           NULL AS COL20,
           
                COUNT(DISTINCT CASE WHEN C.CODUL = R.CAEM2 AND CC.FULL_CODE LIKE '%'||'2222222'||';%' THEN FC.CUIIO END ) AS COL21,
           NULL AS COL22,
           NULL AS COL23,
           NULL AS COL24,
           NULL AS COL25,
           NULL AS COL26,
           NULL AS COL27,
           NULL AS COL28,
           NULL AS COL29,
           NULL AS COL30,
           
           
           COUNT(DISTINCT CASE WHEN C.CODUL = R.CAEM2 AND CC.FULL_CODE LIKE '%'||'3333333'||';%' THEN FC.CUIIO END ) AS COL31,
           NULL AS COL32,
           NULL AS COL33,
           NULL AS COL34,
           NULL AS COL35,
           NULL AS COL36,
           NULL AS COL37,
           NULL AS COL38,
           NULL AS COL39,
           NULL AS COL40,
           
            COUNT(DISTINCT CASE WHEN C.CODUL = R.CAEM2 AND CC.FULL_CODE LIKE '%'||'0100000'||';%' THEN FC.CUIIO END ) AS COL41,
           NULL AS COL42,
           NULL AS COL43,
           NULL AS COL44,
           NULL AS COL45,
           NULL AS COL46,
           NULL AS COL47,
           NULL AS COL48,
           NULL AS COL49,
           NULL AS COL50,
           
           
            COUNT(DISTINCT CASE WHEN C.CODUL = R.CAEM2 AND CC.FULL_CODE LIKE '%'||'9600000'||';%' THEN FC.CUIIO END ) AS COL51,
           NULL AS COL52,
           NULL AS COL53,
           NULL AS COL54,
           NULL AS COL55,
           NULL AS COL56,
           NULL AS COL57,
           NULL AS COL58,
           NULL AS COL59,
           NULL AS COL60
           

           
           
          
           
           
      FROM (SELECT FC.CUIIO,
                   FC.CUIIO_VERS,
                   FC.FORM,
                   FC.FORM_VERS,
                   FC.STATUT
              FROM CIS2.FORM_CUIIO  FC
                   INNER JOIN (  SELECT CUIIO, MAX (CUIIO_VERS) CUIIO_VERS
                                   FROM CIS2.FORM_CUIIO
                                  WHERE FORM IN (:pFORM) AND CUIIO_VERS <= :pPERIOADA
                               GROUP BY CUIIO) BB
                       ON (    BB.CUIIO = FC.CUIIO
                           AND BB.CUIIO_VERS = FC.CUIIO_VERS)
             WHERE FC.FORM IN (:pFORM) AND FC.STATUT <> '3') FC
           INNER JOIN CIS2.RENIM R
               ON (R.CUIIO = FC.CUIIO AND R.CUIIO_VERS = FC.CUIIO_VERS)
               INNER JOIN CIS2.VW_CL_CUATM CC ON CC.CODUL = R.CUATM
               
           
               
                    CROSS JOIN (
                    SELECT C.*
FROM CIS2.VW_CL_CAEM2 C
WHERE 
SUBSTR(C.CODUL, 1, 4) IN (
'B061',
'B081',
'C101',
'C102',
'C103',
'C104',
'C105',
'C106',
'C107',
'C108',
'C109',
'C110',
'C120',
'C131',
'C132',
'C133',
'C139',
'C141',
'C143',
'C151',
'C152',
'C161',
'C162',
'C172',
'C181',
'C192',
'C201',
'C202',
'C203',
'C204',
'C205',
'C206',
'C211',
'C212',
'C221',
'C222',
'C231',
'C233',
'C234',
'C235',
'C236',
'C237',
'C243',
'C244',
'C245',
'C251',
'C252',
'C256',
'C257',
'C259',
'C264',
'C265',
'C271',
'C273',
'C274',
'C281',
'C282',
'C283',
'C284',
'C289',
'C292',
'C293',
'C310',
'C321',
'C323',
'C324',
'C325',
'C329',
'C331',
'C332',
'D351',
'D352',
'D353',
'E360',
'E370',
'E381',
'E382',
'E383',
'G453',
'G461',
'G462',
'G463',
'G464',
'G465',
'G466',
'G467',
'G469',
'G474',
'G475',
'G477',
'G478',
'H492',
'H493',
'H494',
'H495',
'H504',
'H511',
'H512',
'H521',
'H522',
'H531',
'H532',
'J581',
'J582',
'J591',
'J601',
'J602',
'J611',
'J612',
'J613',
'J619',
'J620',
'J631',
'J639',
'K641',
'K649',
'K651',
'K661',
'K662',
'M711',
'M712',
'M721',
'M731',
'M732',
'M741'
)  
                    ) C 
                    
                           

GROUP BY 
C.CODUL


UNION ALL 
SELECT 
  C.CODUL,
  NULL AS COL1,
 COUNT(DISTINCT CASE WHEN  C.CODUL = D.CAEM2 AND D.CUATM_FULL LIKE '%'||'0000000'||';%'  AND  D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 THEN 1 END) AS COL2,
 COUNT(DISTINCT CASE WHEN  C.CODUL = D.CAEM2 AND D.CUATM_FULL LIKE '%'||'0000000'||';%'  AND  D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2') AND D.COL1=1 THEN 1 END) AS COL3,
 COUNT(DISTINCT CASE WHEN  C.CODUL = D.CAEM2 AND D.CUATM_FULL LIKE '%'||'0000000'||';%'  AND  D.CAPITOL||'.'||D.RIND IN ('1042.3.1.1','1042.3.1.2','1042.3.1.3') AND D.COL1=1 THEN 1 END) AS COL4,
 COUNT(DISTINCT CASE WHEN  C.CODUL = D.CAEM2 AND D.CUATM_FULL LIKE '%'||'0000000'||';%'  AND  D.CAPITOL||'.'||D.RIND IN ('1046.7.1.1','1046.7.1.2','1046.7.1.3') AND D.COL1=1 THEN 1 END) AS COL5,
 COUNT(DISTINCT CASE WHEN  C.CODUL = D.CAEM2 AND D.CUATM_FULL LIKE '%'||'0000000'||';%'  AND  D.CAPITOL||'.'||D.RIND IN ('1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 THEN 1 END) AS COL6,
 COUNT(DISTINCT CASE WHEN  C.CODUL = D.CAEM2 AND D.CUATM_FULL LIKE '%'||'0000000'||';%'  AND  D.CAPITOL||'.'||D.RIND IN ('1041.2.3.1') AND D.COL1=1 THEN 1 END) AS COL7,
 COUNT(DISTINCT CASE WHEN  C.CODUL = D.CAEM2 AND D.CUATM_FULL LIKE '%'||'0000000'||';%'  AND  D.CAPITOL||'.'||D.RIND IN ('1041.2.3.2') AND D.COL1=1 THEN 1 END) AS COL8,
 COUNT(DISTINCT CASE WHEN  C.CODUL = D.CAEM2 AND D.CUATM_FULL LIKE '%'||'0000000'||';%'  AND  D.CAPITOL||'.'||D.RIND IN ('1045.5.2.1') AND D.COL1=1 THEN 1 END) AS COL9,
 COUNT(DISTINCT CASE WHEN  C.CODUL = D.CAEM2 AND D.CUATM_FULL LIKE '%'||'0000000'||';%'  AND  D.CAPITOL||'.'||D.RIND IN ('1045.5.2.2') AND D.COL1=1 THEN 1 END) AS COL10,
 
 
 NULL AS COL11,
 COUNT(DISTINCT CASE WHEN  C.CODUL = D.CAEM2 AND D.CUATM_FULL LIKE '%'||'1111111'||';%'  AND  D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 THEN 1 END) AS COL12,
 COUNT(DISTINCT CASE WHEN  C.CODUL = D.CAEM2 AND D.CUATM_FULL LIKE '%'||'1111111'||';%'  AND  D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2') AND D.COL1=1 THEN 1 END) AS COL13,
 COUNT(DISTINCT CASE WHEN  C.CODUL = D.CAEM2 AND D.CUATM_FULL LIKE '%'||'1111111'||';%'  AND  D.CAPITOL||'.'||D.RIND IN ('1042.3.1.1','1042.3.1.2','1042.3.1.3') AND D.COL1=1 THEN 1 END) AS COL14,
 COUNT(DISTINCT CASE WHEN  C.CODUL = D.CAEM2 AND D.CUATM_FULL LIKE '%'||'1111111'||';%'  AND  D.CAPITOL||'.'||D.RIND IN ('1046.7.1.1','1046.7.1.2','1046.7.1.3') AND D.COL1=1 THEN 1 END) AS COL15,
 COUNT(DISTINCT CASE WHEN  C.CODUL = D.CAEM2 AND D.CUATM_FULL LIKE '%'||'1111111'||';%'  AND  D.CAPITOL||'.'||D.RIND IN ('1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 THEN 1 END) AS COL16,
 COUNT(DISTINCT CASE WHEN  C.CODUL = D.CAEM2 AND D.CUATM_FULL LIKE '%'||'1111111'||';%'  AND  D.CAPITOL||'.'||D.RIND IN ('1041.2.3.1') AND D.COL1=1 THEN 1 END) AS COL17,
 COUNT(DISTINCT CASE WHEN  C.CODUL = D.CAEM2 AND D.CUATM_FULL LIKE '%'||'1111111'||';%'  AND  D.CAPITOL||'.'||D.RIND IN ('1041.2.3.2') AND D.COL1=1 THEN 1 END) AS COL18,
 COUNT(DISTINCT CASE WHEN  C.CODUL = D.CAEM2 AND D.CUATM_FULL LIKE '%'||'1111111'||';%'  AND  D.CAPITOL||'.'||D.RIND IN ('1045.5.2.1') AND D.COL1=1 THEN 1 END) AS COL19,
 COUNT(DISTINCT CASE WHEN  C.CODUL = D.CAEM2 AND D.CUATM_FULL LIKE '%'||'1111111'||';%'  AND  D.CAPITOL||'.'||D.RIND IN ('1045.5.2.2') AND D.COL1=1 THEN 1 END) AS COL20,
 
 
  NULL AS COL21,
 COUNT(DISTINCT CASE WHEN  C.CODUL = D.CAEM2 AND D.CUATM_FULL LIKE '%'||'2222222'||';%'  AND  D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 THEN 1 END) AS COL22,
 COUNT(DISTINCT CASE WHEN  C.CODUL = D.CAEM2 AND D.CUATM_FULL LIKE '%'||'2222222'||';%'  AND  D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2') AND D.COL1=1 THEN 1 END) AS COL23,
 COUNT(DISTINCT CASE WHEN  C.CODUL = D.CAEM2 AND D.CUATM_FULL LIKE '%'||'2222222'||';%'  AND  D.CAPITOL||'.'||D.RIND IN ('1042.3.1.1','1042.3.1.2','1042.3.1.3') AND D.COL1=1 THEN 1 END) AS COL24,
 COUNT(DISTINCT CASE WHEN  C.CODUL = D.CAEM2 AND D.CUATM_FULL LIKE '%'||'2222222'||';%'  AND  D.CAPITOL||'.'||D.RIND IN ('1046.7.1.1','1046.7.1.2','1046.7.1.3') AND D.COL1=1 THEN 1 END) AS COL25,
 COUNT(DISTINCT CASE WHEN  C.CODUL = D.CAEM2 AND D.CUATM_FULL LIKE '%'||'2222222'||';%'  AND  D.CAPITOL||'.'||D.RIND IN ('1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 THEN 1 END) AS COL26,
 COUNT(DISTINCT CASE WHEN  C.CODUL = D.CAEM2 AND D.CUATM_FULL LIKE '%'||'2222222'||';%'  AND  D.CAPITOL||'.'||D.RIND IN ('1041.2.3.1') AND D.COL1=1 THEN 1 END) AS COL27,
 COUNT(DISTINCT CASE WHEN  C.CODUL = D.CAEM2 AND D.CUATM_FULL LIKE '%'||'2222222'||';%'  AND  D.CAPITOL||'.'||D.RIND IN ('1041.2.3.2') AND D.COL1=1 THEN 1 END) AS COL28,
 COUNT(DISTINCT CASE WHEN  C.CODUL = D.CAEM2 AND D.CUATM_FULL LIKE '%'||'2222222'||';%'  AND  D.CAPITOL||'.'||D.RIND IN ('1045.5.2.1') AND D.COL1=1 THEN 1 END) AS COL29,
 COUNT(DISTINCT CASE WHEN  C.CODUL = D.CAEM2 AND D.CUATM_FULL LIKE '%'||'2222222'||';%'  AND  D.CAPITOL||'.'||D.RIND IN ('1045.5.2.2') AND D.COL1=1 THEN 1 END) AS COL30,
 
 
 NULL AS COL31,
 COUNT(DISTINCT CASE WHEN  C.CODUL = D.CAEM2 AND D.CUATM_FULL LIKE '%'||'3333333'||';%'  AND  D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 THEN 1 END) AS COL32,
 COUNT(DISTINCT CASE WHEN  C.CODUL = D.CAEM2 AND D.CUATM_FULL LIKE '%'||'3333333'||';%'  AND  D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2') AND D.COL1=1 THEN 1 END) AS COL33,
 COUNT(DISTINCT CASE WHEN  C.CODUL = D.CAEM2 AND D.CUATM_FULL LIKE '%'||'3333333'||';%'  AND  D.CAPITOL||'.'||D.RIND IN ('1042.3.1.1','1042.3.1.2','1042.3.1.3') AND D.COL1=1 THEN 1 END) AS COL34,
 COUNT(DISTINCT CASE WHEN  C.CODUL = D.CAEM2 AND D.CUATM_FULL LIKE '%'||'3333333'||';%'  AND  D.CAPITOL||'.'||D.RIND IN ('1046.7.1.1','1046.7.1.2','1046.7.1.3') AND D.COL1=1 THEN 1 END) AS COL35,
 COUNT(DISTINCT CASE WHEN  C.CODUL = D.CAEM2 AND D.CUATM_FULL LIKE '%'||'3333333'||';%'  AND  D.CAPITOL||'.'||D.RIND IN ('1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 THEN 1 END) AS COL36,
 COUNT(DISTINCT CASE WHEN  C.CODUL = D.CAEM2 AND D.CUATM_FULL LIKE '%'||'3333333'||';%'  AND  D.CAPITOL||'.'||D.RIND IN ('1041.2.3.1') AND D.COL1=1 THEN 1 END) AS COL37,
 COUNT(DISTINCT CASE WHEN  C.CODUL = D.CAEM2 AND D.CUATM_FULL LIKE '%'||'3333333'||';%'  AND  D.CAPITOL||'.'||D.RIND IN ('1041.2.3.2') AND D.COL1=1 THEN 1 END) AS COL38,
 COUNT(DISTINCT CASE WHEN  C.CODUL = D.CAEM2 AND D.CUATM_FULL LIKE '%'||'3333333'||';%'  AND  D.CAPITOL||'.'||D.RIND IN ('1045.5.2.1') AND D.COL1=1 THEN 1 END) AS COL39,
 COUNT(DISTINCT CASE WHEN  C.CODUL = D.CAEM2 AND D.CUATM_FULL LIKE '%'||'3333333'||';%'  AND  D.CAPITOL||'.'||D.RIND IN ('1045.5.2.2') AND D.COL1=1 THEN 1 END) AS COL40,
 
 
 NULL AS COL41,
 COUNT(DISTINCT CASE WHEN  C.CODUL = D.CAEM2 AND D.CUATM_FULL LIKE '%'||'0100000'||';%'  AND  D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 THEN 1 END) AS COL42,
 COUNT(DISTINCT CASE WHEN  C.CODUL = D.CAEM2 AND D.CUATM_FULL LIKE '%'||'0100000'||';%'  AND  D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2') AND D.COL1=1 THEN 1 END) AS COL43,
 COUNT(DISTINCT CASE WHEN  C.CODUL = D.CAEM2 AND D.CUATM_FULL LIKE '%'||'0100000'||';%'  AND  D.CAPITOL||'.'||D.RIND IN ('1042.3.1.1','1042.3.1.2','1042.3.1.3') AND D.COL1=1 THEN 1 END) AS COL44,
 COUNT(DISTINCT CASE WHEN  C.CODUL = D.CAEM2 AND D.CUATM_FULL LIKE '%'||'0100000'||';%'  AND  D.CAPITOL||'.'||D.RIND IN ('1046.7.1.1','1046.7.1.2','1046.7.1.3') AND D.COL1=1 THEN 1 END) AS COL45,
 COUNT(DISTINCT CASE WHEN  C.CODUL = D.CAEM2 AND D.CUATM_FULL LIKE '%'||'0100000'||';%'  AND  D.CAPITOL||'.'||D.RIND IN ('1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 THEN 1 END) AS COL46,
 COUNT(DISTINCT CASE WHEN  C.CODUL = D.CAEM2 AND D.CUATM_FULL LIKE '%'||'0100000'||';%'  AND  D.CAPITOL||'.'||D.RIND IN ('1041.2.3.1') AND D.COL1=1 THEN 1 END) AS COL47,
 COUNT(DISTINCT CASE WHEN  C.CODUL = D.CAEM2 AND D.CUATM_FULL LIKE '%'||'0100000'||';%'  AND  D.CAPITOL||'.'||D.RIND IN ('1041.2.3.2') AND D.COL1=1 THEN 1 END) AS COL48,
 COUNT(DISTINCT CASE WHEN  C.CODUL = D.CAEM2 AND D.CUATM_FULL LIKE '%'||'0100000'||';%'  AND  D.CAPITOL||'.'||D.RIND IN ('1045.5.2.1') AND D.COL1=1 THEN 1 END) AS COL49,
 COUNT(DISTINCT CASE WHEN  C.CODUL = D.CAEM2 AND D.CUATM_FULL LIKE '%'||'0100000'||';%'  AND  D.CAPITOL||'.'||D.RIND IN ('1045.5.2.2') AND D.COL1=1 THEN 1 END) AS COL50,
 
 
  NULL AS COL51,
 COUNT(DISTINCT CASE WHEN  C.CODUL = D.CAEM2 AND D.CUATM_FULL LIKE '%'||'9600000'||';%'  AND  D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 THEN 1 END) AS COL52,
 COUNT(DISTINCT CASE WHEN  C.CODUL = D.CAEM2 AND D.CUATM_FULL LIKE '%'||'9600000'||';%'  AND  D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2') AND D.COL1=1 THEN 1 END) AS COL53,
 COUNT(DISTINCT CASE WHEN  C.CODUL = D.CAEM2 AND D.CUATM_FULL LIKE '%'||'9600000'||';%'  AND  D.CAPITOL||'.'||D.RIND IN ('1042.3.1.1','1042.3.1.2','1042.3.1.3') AND D.COL1=1 THEN 1 END) AS COL54,
 COUNT(DISTINCT CASE WHEN  C.CODUL = D.CAEM2 AND D.CUATM_FULL LIKE '%'||'9600000'||';%'  AND  D.CAPITOL||'.'||D.RIND IN ('1046.7.1.1','1046.7.1.2','1046.7.1.3') AND D.COL1=1 THEN 1 END) AS COL55,
 COUNT(DISTINCT CASE WHEN  C.CODUL = D.CAEM2 AND D.CUATM_FULL LIKE '%'||'9600000'||';%'  AND  D.CAPITOL||'.'||D.RIND IN ('1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 THEN 1 END) AS COL56,
 COUNT(DISTINCT CASE WHEN  C.CODUL = D.CAEM2 AND D.CUATM_FULL LIKE '%'||'9600000'||';%'  AND  D.CAPITOL||'.'||D.RIND IN ('1041.2.3.1') AND D.COL1=1 THEN 1 END) AS COL57,
 COUNT(DISTINCT CASE WHEN  C.CODUL = D.CAEM2 AND D.CUATM_FULL LIKE '%'||'9600000'||';%'  AND  D.CAPITOL||'.'||D.RIND IN ('1041.2.3.2') AND D.COL1=1 THEN 1 END) AS COL58,
 COUNT(DISTINCT CASE WHEN  C.CODUL = D.CAEM2 AND D.CUATM_FULL LIKE '%'||'9600000'||';%'  AND  D.CAPITOL||'.'||D.RIND IN ('1045.5.2.1') AND D.COL1=1 THEN 1 END) AS COL59,
 COUNT(DISTINCT CASE WHEN  C.CODUL = D.CAEM2 AND D.CUATM_FULL LIKE '%'||'9600000'||';%'  AND  D.CAPITOL||'.'||D.RIND IN ('1045.5.2.2') AND D.COL1=1 THEN 1 END) AS COL60
 
 
 
 
FROM
  VW_DATA_ALL D


CROSS JOIN (
                    SELECT C.*
FROM CIS2.VW_CL_CAEM2 C
WHERE 
SUBSTR(C.CODUL, 1, 4) IN (
'B061',
'B081',
'C101',
'C102',
'C103',
'C104',
'C105',
'C106',
'C107',
'C108',
'C109',
'C110',
'C120',
'C131',
'C132',
'C133',
'C139',
'C141',
'C143',
'C151',
'C152',
'C161',
'C162',
'C172',
'C181',
'C192',
'C201',
'C202',
'C203',
'C204',
'C205',
'C206',
'C211',
'C212',
'C221',
'C222',
'C231',
'C233',
'C234',
'C235',
'C236',
'C237',
'C243',
'C244',
'C245',
'C251',
'C252',
'C256',
'C257',
'C259',
'C264',
'C265',
'C271',
'C273',
'C274',
'C281',
'C282',
'C283',
'C284',
'C289',
'C292',
'C293',
'C310',
'C321',
'C323',
'C324',
'C325',
'C329',
'C331',
'C332',
'D351',
'D352',
'D353',
'E360',
'E370',
'E381',
'E382',
'E383',
'G453',
'G461',
'G462',
'G463',
'G464',
'G465',
'G466',
'G467',
'G469',
'G474',
'G475',
'G477',
'G478',
'H492',
'H493',
'H494',
'H495',
'H504',
'H511',
'H512',
'H521',
'H522',
'H531',
'H532',
'J581',
'J582',
'J591',
'J601',
'J602',
'J611',
'J612',
'J613',
'J619',
'J620',
'J631',
'J639',
'K641',
'K649',
'K651',
'K661',
'K662',
'M711',
'M712',
'M721',
'M731',
'M732',
'M741'
)  
                    ) C 
WHERE
  D.PERIOADA IN (:pPERIOADA) AND 
  D.FORM_VERS = :pFORM_VERS     AND   
  D.FORM= :pFORM     AND    
 -- D.CUATM_FULL LIKE '%'||'0000000'||';%'  AND 
  D.FORM IN (48)
GROUP BY
  C.CODUL
)  

GROUP BY 
CODUL

    
--HAVING 
----COL3 <> 0
----AND 
----COL4 <> 4
----
----AND 
--CODUL IN ('C1102')
  ORDER BY
  CODUL


