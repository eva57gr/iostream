SELECT

CASE WHEN CIS2.NVAL(SUM(CASE WHEN D.CAPITOL||'.'||D.RIND = '1044.4.1' THEN D.COL1 ELSE 0 END)) <= 0 

   THEN    'Nu ati completat Rind. 4.2 ' 
   
   WHEN MAX(CASE WHEN D.CAPITOL||'.'||D.RIND = '1044.4.2' THEN D.COL31 ELSE NULL END) IS NULL 
   
   THEN    'Nu ati completat Rind. 42 '
   
   WHEN LENGTH(MAX(CASE WHEN D.CAPITOL||'.'||D.RIND = '1044.4.2' THEN D.COL31 ELSE NULL END)) < 7
   
   THEN    'Randul  4.2 contine mai putin de 7 caractere'
   
   END  
   AS REZULTAT
  
  
FROM
  CIS2.VW_DATA_ALL D
WHERE
  (D.PERIOADA=:PERIOADA          ) AND
  (D.CUIIO=:CUIIO                ) AND
  (D.CUIIO_VERS=:CUIIO_VERS     OR :CUIIO_VERS = -1) AND
  (D.FORM = :FORM               ) AND
  (D.FORM_VERS=:FORM_VERS ) AND
  (D.CAPITOL=:CAPITOL           OR :CAPITOL = -1) AND
  (D.CAPITOL_VERS=:CAPITOL_VERS OR :CAPITOL_VERS = -1) AND
  (D.ID_MD=:ID_MD               OR :ID_MD = -1) AND
  
  D.FORM IN (48)  AND
  D.CAPITOL IN (100,1044) 
  
  
  
HAVING
(
  CIS2.NVAL(SUM(CASE WHEN D.CAPITOL||'.'||D.RIND = '1044.4.1' THEN D.COL1 ELSE 0 END)) <= 0
  OR 
  (
    MAX(CASE WHEN D.CAPITOL||'.'||D.RIND = '1044.4.2' THEN D.COL31 ELSE NULL END) IS NULL
    OR 
    LENGTH(MAX(CASE WHEN D.CAPITOL||'.'||D.RIND = '1044.4.2' THEN D.COL31 ELSE NULL END)) < 7
  )
)
AND CIS2.NVAL(SUM(CASE WHEN D.CAPITOL||'.'||D.RIND = '100.01' THEN D.COL1 ELSE 0 END)) IN (1)
