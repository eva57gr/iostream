--INSERT INTO CIS2.TABLE_OUT 
--(
--  PERIOADA,
--  FORM,
--  FORM_VERS,
--  ID_MDTABLE,
--  COD_CUATM,
--  NR_SECTIE,
--  NUME_SECTIE,
--  NR_SECTIE1,
--  NUME_SECTIE1,
--  NR_SECTIE2,
--  NUME_SECTIE2,
--  NR_ROW,
--  ORDINE,
--  DECIMAL_POS,
--  NUME_ROW,  
--  COL1,
--  COL2,
--  COL3,
--  COL4,
--  COL5,
--  COL6
--)

SELECT
  :pPERIOADA AS PERIOADA,
  :pFORM AS FORM,
  :pFORM_VERS AS FORM_VERS,
  :pID_MDTABLE AS ID_MDTABLE,
  :pCOD_CUATM AS COD_CUATM,
         
  '0' AS  NR_SECTIE,
  '0' AS  NUME_SECTIE,
  '0' AS NR_SECTIE1,
  '0' AS NUME_SECTIE1,
  '0' as NR_SECTIE2,
  '0' as NUME_SECTIE2,
  NR_ROW AS NR_ROW,
  1 ORDINE,
  '00000000' AS DECIMAL_POS,
  NUME_ROW AS NUME_ROW,
  COL1,
  COL2,
  COL3,
  COL4,
  COL5,
  COL6
  
  FROM (
  SELECT 
  NR_ROW,  
  NUME_ROW,
  SUM(COL5) AS COL1,
  SUM(COL5_1) AS COL2,
  SUM(COL5_2) AS COL3,
  SUM(COL5_3) AS COL4,
  SUM(COL5_4) AS COL5,
  SUM(COL5_5) AS COL6
FROM
(
SELECT 
D.CUIIO,
  '01' AS NR_ROW,
  'TOTAL 'AS NUME_ROW,
 
 CIS2.NVAL(MAX(CASE WHEN D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5,
CIS2.NVAL(MAX(CASE WHEN D.CUATM_FULL LIKE '%;0100000%' AND D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5_1,
 CIS2.NVAL(MAX(CASE WHEN D.CUATM_FULL LIKE '%;1111111%' AND D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5_2,
 CIS2.NVAL(MAX(CASE WHEN D.CUATM_FULL LIKE '%;2222222%' AND D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5_3,
 CIS2.NVAL(MAX(CASE WHEN D.CUATM_FULL LIKE '%;3333333%' AND D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5_4,
 CIS2.NVAL(MAX(CASE WHEN D.CUATM_FULL LIKE '%;9600000%' AND D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5_5

  
  FROM 
  CIS2.VW_DATA_ALL D    
  INNER JOIN CIS2.VW_CL_CAEM2 CC ON (D.CAEM2=CC.CODUL AND CC.FULL_CODE LIKE '%'||D.CAEM2||';%')
    

WHERE
  D.PERIOADA IN (:pPERIOADA) AND 
  D.FORM_VERS = :pFORM_VERS     AND   
  D.FORM= :pFORM     AND    
  (:pID_MDTABLE=:pID_MDTABLE) AND
  D.CUATM_FULL LIKE '%'||:pCOD_CUATM||';%' AND
  D.FORM IN (48)  
   GROUP BY D.CUIIO
  )  
  GROUP BY NR_ROW, NUME_ROW)
  
 UNION
 
 
SELECT
  :pPERIOADA AS PERIOADA,
  :pFORM AS FORM,
  :pFORM_VERS AS FORM_VERS,
  :pID_MDTABLE AS ID_MDTABLE,
  :pCOD_CUATM AS COD_CUATM,
         
  '0' AS  NR_SECTIE,
  '0' AS  NUME_SECTIE,
  '0' AS NR_SECTIE1,
  '0' AS NUME_SECTIE1,
  '0' as NR_SECTIE2,
  '0' as NUME_SECTIE2,
  NR_ROW AS NR_ROW,
  2 ORDINE,
  '00000000' AS DECIMAL_POS,
  NUME_ROW AS NUME_ROW,
  COL1,
  COL2,
  COL3,
  COL4,
  COL5,
  COL6
  
  FROM (
  SELECT 
  NR_ROW,  
  NUME_ROW,
  SUM(COL5) AS COL1,
  SUM(COL5_1) AS COL2,
  SUM(COL5_2) AS COL3,
  SUM(COL5_3) AS COL4,
  SUM(COL5_4) AS COL5,
  SUM(COL5_5) AS COL6
FROM
(
SELECT 
D.CUIIO,
  '02' AS NR_ROW,
  '10-49 salariati 'AS NUME_ROW,
 
 CIS2.NVAL(MAX(CASE WHEN D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5,
CIS2.NVAL(MAX(CASE WHEN D.CUATM_FULL LIKE '%;0100000%' AND D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5_1,
 CIS2.NVAL(MAX(CASE WHEN D.CUATM_FULL LIKE '%;1111111%' AND D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5_2,
 CIS2.NVAL(MAX(CASE WHEN D.CUATM_FULL LIKE '%;2222222%' AND D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5_3,
 CIS2.NVAL(MAX(CASE WHEN D.CUATM_FULL LIKE '%;3333333%' AND D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5_4,
 CIS2.NVAL(MAX(CASE WHEN D.CUATM_FULL LIKE '%;9600000%' AND D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5_5
  
  FROM 
  CIS2.VW_DATA_ALL D    
  INNER JOIN CIS2.VW_CL_CAEM2 CC ON (D.CAEM2=CC.CODUL AND CC.FULL_CODE LIKE '%'||D.CAEM2||';%')
  INNER JOIN
  CIS2.X_BAZA_SONDAJ BS ON D.CUIIO=BS.CUIIO AND D.ANUL = BS.ANUL

WHERE
  D.PERIOADA IN (:pPERIOADA) AND 
  D.FORM_VERS = :pFORM_VERS     AND   
  D.FORM= :pFORM     AND    
  (:pID_MDTABLE=:pID_MDTABLE) AND
  D.CUATM_FULL LIKE '%'||:pCOD_CUATM||';%' AND
  D.FORM IN (48)  AND
  BS.PERS_IT BETWEEN 0 AND 49
   GROUP BY D.CUIIO
  )  
  GROUP BY NR_ROW, NUME_ROW)
  
  UNION
 
SELECT
  :pPERIOADA AS PERIOADA,
  :pFORM AS FORM,
  :pFORM_VERS AS FORM_VERS,
  :pID_MDTABLE AS ID_MDTABLE,
  :pCOD_CUATM AS COD_CUATM,
         
  '0' AS  NR_SECTIE,
  '0' AS  NUME_SECTIE,
  '0' AS NR_SECTIE1,
  '0' AS NUME_SECTIE1,
  '0' as NR_SECTIE2,
  '0' as NUME_SECTIE2,
  NR_ROW AS NR_ROW,
  3 ORDINE,
  '00000000' AS DECIMAL_POS,
  NUME_ROW AS NUME_ROW,
  COL1,
  COL2,
  COL3,
  COL4,
  COL5,
  COL6
  
  FROM (
  SELECT 
  NR_ROW,  
  NUME_ROW,
  SUM(COL5) AS COL1,
  SUM(COL5_1) AS COL2,
  SUM(COL5_2) AS COL3,
  SUM(COL5_3) AS COL4,
  SUM(COL5_4) AS COL5,
  SUM(COL5_5) AS COL6
FROM
(
SELECT 
  D.CUIIO,
  '03' AS NR_ROW,
  '50-249 salaria?i' AS NUME_ROW,
 
 CIS2.NVAL(MAX(CASE WHEN D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5,
CIS2.NVAL(MAX(CASE WHEN D.CUATM_FULL LIKE '%;0100000%' AND D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5_1,
 CIS2.NVAL(MAX(CASE WHEN D.CUATM_FULL LIKE '%;1111111%' AND D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5_2,
 CIS2.NVAL(MAX(CASE WHEN D.CUATM_FULL LIKE '%;2222222%' AND D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5_3,
 CIS2.NVAL(MAX(CASE WHEN D.CUATM_FULL LIKE '%;3333333%' AND D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5_4,
 CIS2.NVAL(MAX(CASE WHEN D.CUATM_FULL LIKE '%;9600000%' AND D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5_5

  
  FROM 
  CIS2.VW_DATA_ALL D    
  INNER JOIN CIS2.VW_CL_CAEM2 CC ON (D.CAEM2=CC.CODUL AND CC.FULL_CODE LIKE '%'||D.CAEM2||';%')
  INNER JOIN
  CIS2.X_BAZA_SONDAJ BS ON D.CUIIO=BS.CUIIO AND D.ANUL = BS.ANUL

WHERE
  D.PERIOADA IN (:pPERIOADA) AND 
  D.FORM_VERS = :pFORM_VERS     AND   
  D.FORM= :pFORM     AND    
  (:pID_MDTABLE=:pID_MDTABLE) AND
  D.CUATM_FULL LIKE '%'||:pCOD_CUATM||';%' AND
  D.FORM IN (48)  AND
  BS.PERS_IT BETWEEN 50 AND 249
   GROUP BY D.CUIIO
  )  
  GROUP BY NR_ROW, NUME_ROW)
  
   UNION
 
SELECT
  :pPERIOADA AS PERIOADA,
  :pFORM AS FORM,
  :pFORM_VERS AS FORM_VERS,
  :pID_MDTABLE AS ID_MDTABLE,
  :pCOD_CUATM AS COD_CUATM,
         
  '0' AS  NR_SECTIE,
  '0' AS  NUME_SECTIE,
  '0' AS NR_SECTIE1,
  '0' AS NUME_SECTIE1,
  '0' as NR_SECTIE2,
  '0' as NUME_SECTIE2,
  NR_ROW AS NR_ROW,
  4 ORDINE,
  '00000000' AS DECIMAL_POS,
  NUME_ROW AS NUME_ROW,
  COL1,
  COL2,
  COL3,
  COL4,
  COL5,
  COL6
  
  FROM (
  SELECT 
  NR_ROW,  
  NUME_ROW,
  SUM(COL5) AS COL1,
  SUM(COL5_1) AS COL2,
  SUM(COL5_2) AS COL3,
  SUM(COL5_3) AS COL4,
  SUM(COL5_4) AS COL5,
  SUM(COL5_5) AS COL6
FROM
(
SELECT 
  D.CUIIO,
  '04' AS NR_ROW,
  '250 ?i peste salaria?i' AS NUME_ROW,
 
 CIS2.NVAL(MAX(CASE WHEN D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5,
CIS2.NVAL(MAX(CASE WHEN D.CUATM_FULL LIKE '%;0100000%' AND D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5_1,
 CIS2.NVAL(MAX(CASE WHEN D.CUATM_FULL LIKE '%;1111111%' AND D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5_2,
 CIS2.NVAL(MAX(CASE WHEN D.CUATM_FULL LIKE '%;2222222%' AND D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5_3,
 CIS2.NVAL(MAX(CASE WHEN D.CUATM_FULL LIKE '%;3333333%' AND D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5_4,
 CIS2.NVAL(MAX(CASE WHEN D.CUATM_FULL LIKE '%;9600000%' AND D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5_5

  
  FROM 
  CIS2.VW_DATA_ALL D    
  INNER JOIN CIS2.VW_CL_CAEM2 CC ON (D.CAEM2=CC.CODUL AND CC.FULL_CODE LIKE '%'||D.CAEM2||';%')
  INNER JOIN
  CIS2.X_BAZA_SONDAJ BS ON D.CUIIO=BS.CUIIO AND D.ANUL = BS.ANUL

WHERE
  D.PERIOADA IN (:pPERIOADA) AND 
  D.FORM_VERS = :pFORM_VERS     AND   
  D.FORM= :pFORM     AND    
  (:pID_MDTABLE=:pID_MDTABLE) AND
  D.CUATM_FULL LIKE '%'||:pCOD_CUATM||';%' AND
  D.FORM IN (48)  AND
  BS.PERS_IT >=250
   GROUP BY D.CUIIO
  )  
  GROUP BY NR_ROW, NUME_ROW)
  
  -------------INDUSTRIE
  UNION
  
SELECT
  :pPERIOADA AS PERIOADA,
  :pFORM AS FORM,
  :pFORM_VERS AS FORM_VERS,
  :pID_MDTABLE AS ID_MDTABLE,
  :pCOD_CUATM AS COD_CUATM,
         
  '0' AS  NR_SECTIE,
  '0' AS  NUME_SECTIE,
  '0' AS NR_SECTIE1,
  '0' AS NUME_SECTIE1,
  '0' as NR_SECTIE2,
  '0' as NUME_SECTIE2,
  NR_ROW AS NR_ROW,
  5 ORDINE,
  '00000000' AS DECIMAL_POS,
  NUME_ROW AS NUME_ROW,
  COL1,
  COL2,
  COL3,
  COL4,
  COL5,
  COL6
  
  FROM (
  SELECT 
  NR_ROW,  
  NUME_ROW,
  SUM(COL5) AS COL1,
  SUM(COL5_1) AS COL2,
  SUM(COL5_2) AS COL3,
  SUM(COL5_3) AS COL4,
  SUM(COL5_4) AS COL5,
  SUM(COL5_5) AS COL6
FROM
(
SELECT 
D.CUIIO,
  '05' AS NR_ROW,
  'Industrie - TOTAL 'AS NUME_ROW,
 
 CIS2.NVAL(MAX(CASE WHEN D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5,
CIS2.NVAL(MAX(CASE WHEN D.CUATM_FULL LIKE '%;0100000%' AND D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5_1,
 CIS2.NVAL(MAX(CASE WHEN D.CUATM_FULL LIKE '%;1111111%' AND D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5_2,
 CIS2.NVAL(MAX(CASE WHEN D.CUATM_FULL LIKE '%;2222222%' AND D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5_3,
 CIS2.NVAL(MAX(CASE WHEN D.CUATM_FULL LIKE '%;3333333%' AND D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5_4,
 CIS2.NVAL(MAX(CASE WHEN D.CUATM_FULL LIKE '%;9600000%' AND D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5_5

  
  FROM 
  CIS2.VW_DATA_ALL D    
  INNER JOIN CIS2.VW_CL_CAEM2 CC ON (D.CAEM2=CC.CODUL AND CC.FULL_CODE LIKE '%'||D.CAEM2||';%')
    

WHERE
  D.PERIOADA IN (:pPERIOADA) AND 
  D.FORM_VERS = :pFORM_VERS     AND   
  D.FORM= :pFORM     AND    
  (:pID_MDTABLE=:pID_MDTABLE) AND
  D.CUATM_FULL LIKE '%'||:pCOD_CUATM||';%' AND
  D.FORM IN (48)    AND
  D.CAEM2 BETWEEN 'B0000000' AND 'E3900' 
  
   GROUP BY D.CUIIO
  )  
  GROUP BY NR_ROW, NUME_ROW)
  
 UNION
 
 
SELECT
  :pPERIOADA AS PERIOADA,
  :pFORM AS FORM,
  :pFORM_VERS AS FORM_VERS,
  :pID_MDTABLE AS ID_MDTABLE,
  :pCOD_CUATM AS COD_CUATM,
         
  '0' AS  NR_SECTIE,
  '0' AS  NUME_SECTIE,
  '0' AS NR_SECTIE1,
  '0' AS NUME_SECTIE1,
  '0' as NR_SECTIE2,
  '0' as NUME_SECTIE2,
  NR_ROW AS NR_ROW,
  6 ORDINE,
  '00000000' AS DECIMAL_POS,
  NUME_ROW AS NUME_ROW,
  COL1,
  COL2,
  COL3,
  COL4,
  COL5,
  COL6
  
  FROM (
  SELECT 
  NR_ROW,  
  NUME_ROW,
  SUM(COL5) AS COL1,
  SUM(COL5_1) AS COL2,
  SUM(COL5_2) AS COL3,
  SUM(COL5_3) AS COL4,
  SUM(COL5_4) AS COL5,
  SUM(COL5_5) AS COL6
FROM
(
SELECT 
D.CUIIO,
  '06' AS NR_ROW,
  '10-49 salariati 'AS NUME_ROW,
 
 CIS2.NVAL(MAX(CASE WHEN D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5,
CIS2.NVAL(MAX(CASE WHEN D.CUATM_FULL LIKE '%;0100000%' AND D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5_1,
 CIS2.NVAL(MAX(CASE WHEN D.CUATM_FULL LIKE '%;1111111%' AND D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5_2,
 CIS2.NVAL(MAX(CASE WHEN D.CUATM_FULL LIKE '%;2222222%' AND D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5_3,
 CIS2.NVAL(MAX(CASE WHEN D.CUATM_FULL LIKE '%;3333333%' AND D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5_4,
 CIS2.NVAL(MAX(CASE WHEN D.CUATM_FULL LIKE '%;9600000%' AND D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5_5

  
  FROM 
  CIS2.VW_DATA_ALL D    
  INNER JOIN CIS2.VW_CL_CAEM2 CC ON (D.CAEM2=CC.CODUL AND CC.FULL_CODE LIKE '%'||D.CAEM2||';%')
  INNER JOIN
  CIS2.X_BAZA_SONDAJ BS ON D.CUIIO=BS.CUIIO AND D.ANUL = BS.ANUL

WHERE
  D.PERIOADA IN (:pPERIOADA) AND 
  D.FORM_VERS = :pFORM_VERS     AND   
  D.FORM= :pFORM     AND    
  (:pID_MDTABLE=:pID_MDTABLE) AND
  D.CUATM_FULL LIKE '%'||:pCOD_CUATM||';%' AND
  D.FORM IN (48)  AND
  BS.PERS_IT BETWEEN 0 AND 49   AND
  D.CAEM2 BETWEEN 'B0000000' AND 'E3900' 
   GROUP BY D.CUIIO
  )  
  GROUP BY NR_ROW, NUME_ROW)
  
  UNION
 
SELECT
  :pPERIOADA AS PERIOADA,
  :pFORM AS FORM,
  :pFORM_VERS AS FORM_VERS,
  :pID_MDTABLE AS ID_MDTABLE,
  :pCOD_CUATM AS COD_CUATM,
         
  '0' AS  NR_SECTIE,
  '0' AS  NUME_SECTIE,
  '0' AS NR_SECTIE1,
  '0' AS NUME_SECTIE1,
  '0' as NR_SECTIE2,
  '0' as NUME_SECTIE2,
  NR_ROW AS NR_ROW,
  7 ORDINE,
  '00000000' AS DECIMAL_POS,
  NUME_ROW AS NUME_ROW,
  COL1,
  COL2,
  COL3,
  COL4,
  COL5,
  COL6
  
  FROM (
  SELECT 
  NR_ROW,  
  NUME_ROW,
  SUM(COL5) AS COL1,
  SUM(COL5_1) AS COL2,
  SUM(COL5_2) AS COL3,
  SUM(COL5_3) AS COL4,
  SUM(COL5_4) AS COL5,
  SUM(COL5_5) AS COL6
FROM
(
SELECT 
  D.CUIIO,
  '07' AS NR_ROW,
  '50-249 salaria?i' AS NUME_ROW,
 
 CIS2.NVAL(MAX(CASE WHEN D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5,
CIS2.NVAL(MAX(CASE WHEN D.CUATM_FULL LIKE '%;0100000%' AND D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5_1,
 CIS2.NVAL(MAX(CASE WHEN D.CUATM_FULL LIKE '%;1111111%' AND D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5_2,
 CIS2.NVAL(MAX(CASE WHEN D.CUATM_FULL LIKE '%;2222222%' AND D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5_3,
 CIS2.NVAL(MAX(CASE WHEN D.CUATM_FULL LIKE '%;3333333%' AND D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5_4,
 CIS2.NVAL(MAX(CASE WHEN D.CUATM_FULL LIKE '%;9600000%' AND D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5_5

  
  FROM 
  CIS2.VW_DATA_ALL D    
  INNER JOIN CIS2.VW_CL_CAEM2 CC ON (D.CAEM2=CC.CODUL AND CC.FULL_CODE LIKE '%'||D.CAEM2||';%')
  INNER JOIN
  CIS2.X_BAZA_SONDAJ BS ON D.CUIIO=BS.CUIIO AND D.ANUL = BS.ANUL

WHERE
  D.PERIOADA IN (:pPERIOADA) AND 
  D.FORM_VERS = :pFORM_VERS     AND   
  D.FORM= :pFORM     AND    
  (:pID_MDTABLE=:pID_MDTABLE) AND
  D.CUATM_FULL LIKE '%'||:pCOD_CUATM||';%' AND
  D.FORM IN (48)  AND
  BS.PERS_IT BETWEEN 50 AND 249   AND
  D.CAEM2 BETWEEN 'B0000000' AND 'E3900' 
   GROUP BY D.CUIIO
  )  
  GROUP BY NR_ROW, NUME_ROW)
  
   UNION
 
SELECT
  :pPERIOADA AS PERIOADA,
  :pFORM AS FORM,
  :pFORM_VERS AS FORM_VERS,
  :pID_MDTABLE AS ID_MDTABLE,
  :pCOD_CUATM AS COD_CUATM,
         
  '0' AS  NR_SECTIE,
  '0' AS  NUME_SECTIE,
  '0' AS NR_SECTIE1,
  '0' AS NUME_SECTIE1,
  '0' as NR_SECTIE2,
  '0' as NUME_SECTIE2,
  NR_ROW AS NR_ROW,
  8 ORDINE,
  '00000000' AS DECIMAL_POS,
  NUME_ROW AS NUME_ROW,
  COL1,
  COL2,
  COL3,
  COL4,
  COL5,
  COL6
  
  FROM (
  SELECT 
  NR_ROW,  
  NUME_ROW,
  SUM(COL5) AS COL1,
  SUM(COL5_1) AS COL2,
  SUM(COL5_2) AS COL3,
  SUM(COL5_3) AS COL4,
  SUM(COL5_4) AS COL5,
  SUM(COL5_5) AS COL6
FROM
(
SELECT 
  D.CUIIO,
  '08' AS NR_ROW,
  '250 ?i peste salaria?i' AS NUME_ROW,
 
 CIS2.NVAL(MAX(CASE WHEN D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5,
CIS2.NVAL(MAX(CASE WHEN D.CUATM_FULL LIKE '%;0100000%' AND D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5_1,
 CIS2.NVAL(MAX(CASE WHEN D.CUATM_FULL LIKE '%;1111111%' AND D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5_2,
 CIS2.NVAL(MAX(CASE WHEN D.CUATM_FULL LIKE '%;2222222%' AND D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5_3,
 CIS2.NVAL(MAX(CASE WHEN D.CUATM_FULL LIKE '%;3333333%' AND D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5_4,
 CIS2.NVAL(MAX(CASE WHEN D.CUATM_FULL LIKE '%;9600000%' AND D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5_5

  
  FROM 
  CIS2.VW_DATA_ALL D    
  INNER JOIN CIS2.VW_CL_CAEM2 CC ON (D.CAEM2=CC.CODUL AND CC.FULL_CODE LIKE '%'||D.CAEM2||';%')
  INNER JOIN
  CIS2.X_BAZA_SONDAJ BS ON D.CUIIO=BS.CUIIO AND D.ANUL = BS.ANUL

WHERE
  D.PERIOADA IN (:pPERIOADA) AND 
  D.FORM_VERS = :pFORM_VERS     AND   
  D.FORM= :pFORM     AND    
  (:pID_MDTABLE=:pID_MDTABLE) AND
  D.CUATM_FULL LIKE '%'||:pCOD_CUATM||';%' AND
  D.FORM IN (48)  AND
  BS.PERS_IT >=250   AND
  D.CAEM2 BETWEEN 'B0000000' AND 'E3900' 
   GROUP BY D.CUIIO
  )  
  GROUP BY NR_ROW, NUME_ROW)
  
    -------------SERVICII
  UNION
  
SELECT
  :pPERIOADA AS PERIOADA,
  :pFORM AS FORM,
  :pFORM_VERS AS FORM_VERS,
  :pID_MDTABLE AS ID_MDTABLE,
  :pCOD_CUATM AS COD_CUATM,
         
  '0' AS  NR_SECTIE,
  '0' AS  NUME_SECTIE,
  '0' AS NR_SECTIE1,
  '0' AS NUME_SECTIE1,
  '0' as NR_SECTIE2,
  '0' as NUME_SECTIE2,
  NR_ROW AS NR_ROW,
  9 ORDINE,
  '00000000' AS DECIMAL_POS,
  NUME_ROW AS NUME_ROW,
  COL1,
  COL2,
  COL3,
  COL4,
  COL5,
  COL6
  
  FROM (
  SELECT 
  NR_ROW,  
  NUME_ROW,
  SUM(COL5) AS COL1,
  SUM(COL5_1) AS COL2,
  SUM(COL5_2) AS COL3,
  SUM(COL5_3) AS COL4,
  SUM(COL5_4) AS COL5,
  SUM(COL5_5) AS COL6
FROM
(
SELECT 
D.CUIIO,
  '09' AS NR_ROW,
  'Servicii - TOTAL 'AS NUME_ROW,
 
 CIS2.NVAL(MAX(CASE WHEN D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5,
CIS2.NVAL(MAX(CASE WHEN D.CUATM_FULL LIKE '%;0100000%' AND D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5_1,
 CIS2.NVAL(MAX(CASE WHEN D.CUATM_FULL LIKE '%;1111111%' AND D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5_2,
 CIS2.NVAL(MAX(CASE WHEN D.CUATM_FULL LIKE '%;2222222%' AND D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5_3,
 CIS2.NVAL(MAX(CASE WHEN D.CUATM_FULL LIKE '%;3333333%' AND D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5_4,
 CIS2.NVAL(MAX(CASE WHEN D.CUATM_FULL LIKE '%;9600000%' AND D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5_5

  
  FROM 
  CIS2.VW_DATA_ALL D    
  INNER JOIN CIS2.VW_CL_CAEM2 CC ON (D.CAEM2=CC.CODUL AND CC.FULL_CODE LIKE '%'||D.CAEM2||';%')
    

WHERE
  D.PERIOADA IN (:pPERIOADA) AND 
  D.FORM_VERS = :pFORM_VERS     AND   
  D.FORM= :pFORM     AND    
  (:pID_MDTABLE=:pID_MDTABLE) AND
  D.CUATM_FULL LIKE '%'||:pCOD_CUATM||';%' AND
  D.FORM IN (48)    AND(
  D.CAEM2 BETWEEN 'G46000'  AND 'M7320' ) 
  
   GROUP BY D.CUIIO
  )  
  GROUP BY NR_ROW, NUME_ROW)
  
 UNION
 
 
SELECT
  :pPERIOADA AS PERIOADA,
  :pFORM AS FORM,
  :pFORM_VERS AS FORM_VERS,
  :pID_MDTABLE AS ID_MDTABLE,
  :pCOD_CUATM AS COD_CUATM,
         
  '0' AS  NR_SECTIE,
  '0' AS  NUME_SECTIE,
  '0' AS NR_SECTIE1,
  '0' AS NUME_SECTIE1,
  '0' as NR_SECTIE2,
  '0' as NUME_SECTIE2,
  NR_ROW AS NR_ROW,
  10 ORDINE,
  '00000000' AS DECIMAL_POS,
  NUME_ROW AS NUME_ROW,
  COL1,
  COL2,
  COL3,
  COL4,
  COL5,
  COL6
  
  FROM (
  SELECT 
  NR_ROW,  
  NUME_ROW,
  SUM(COL5) AS COL1,
  SUM(COL5_1) AS COL2,
  SUM(COL5_2) AS COL3,
  SUM(COL5_3) AS COL4,
  SUM(COL5_4) AS COL5,
  SUM(COL5_5) AS COL6
FROM
(
SELECT 
D.CUIIO,
  '10' AS NR_ROW,
  '10-49 salariati 'AS NUME_ROW,
 
 CIS2.NVAL(MAX(CASE WHEN D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5,
CIS2.NVAL(MAX(CASE WHEN D.CUATM_FULL LIKE '%;0100000%' AND D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5_1,
 CIS2.NVAL(MAX(CASE WHEN D.CUATM_FULL LIKE '%;1111111%' AND D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5_2,
 CIS2.NVAL(MAX(CASE WHEN D.CUATM_FULL LIKE '%;2222222%' AND D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5_3,
 CIS2.NVAL(MAX(CASE WHEN D.CUATM_FULL LIKE '%;3333333%' AND D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5_4,
 CIS2.NVAL(MAX(CASE WHEN D.CUATM_FULL LIKE '%;9600000%' AND D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5_5

  
  FROM 
  CIS2.VW_DATA_ALL D    
  INNER JOIN CIS2.VW_CL_CAEM2 CC ON (D.CAEM2=CC.CODUL AND CC.FULL_CODE LIKE '%'||D.CAEM2||';%')
  INNER JOIN
  CIS2.X_BAZA_SONDAJ BS ON D.CUIIO=BS.CUIIO AND D.ANUL = BS.ANUL

WHERE
  D.PERIOADA IN (:pPERIOADA) AND 
  D.FORM_VERS = :pFORM_VERS     AND   
  D.FORM= :pFORM     AND    
  (:pID_MDTABLE=:pID_MDTABLE) AND
  D.CUATM_FULL LIKE '%'||:pCOD_CUATM||';%' AND
  D.FORM IN (48)  AND
  BS.PERS_IT BETWEEN 0 AND 49   AND(
  D.CAEM2 BETWEEN 'G46000'  AND 'M7320' ) 
   GROUP BY D.CUIIO
  )  
  GROUP BY NR_ROW, NUME_ROW)
  
  UNION
 
SELECT
  :pPERIOADA AS PERIOADA,
  :pFORM AS FORM,
  :pFORM_VERS AS FORM_VERS,
  :pID_MDTABLE AS ID_MDTABLE,
  :pCOD_CUATM AS COD_CUATM,
         
  '0' AS  NR_SECTIE,
  '0' AS  NUME_SECTIE,
  '0' AS NR_SECTIE1,
  '0' AS NUME_SECTIE1,
  '0' as NR_SECTIE2,
  '0' as NUME_SECTIE2,
  NR_ROW AS NR_ROW,
  11 ORDINE,
  '00000000' AS DECIMAL_POS,
  NUME_ROW AS NUME_ROW,
  COL1,
  COL2,
  COL3,
  COL4,
  COL5,
  COL6
  
  FROM (
  SELECT 
  NR_ROW,  
  NUME_ROW,
  SUM(COL5) AS COL1,
  SUM(COL5_1) AS COL2,
  SUM(COL5_2) AS COL3,
  SUM(COL5_3) AS COL4,
  SUM(COL5_4) AS COL5,
  SUM(COL5_5) AS COL6
FROM
(
SELECT 
  D.CUIIO,
  '11' AS NR_ROW,
  '50-249 salaria?i' AS NUME_ROW,
 
 CIS2.NVAL(MAX(CASE WHEN D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5,
CIS2.NVAL(MAX(CASE WHEN D.CUATM_FULL LIKE '%;0100000%' AND D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5_1,
 CIS2.NVAL(MAX(CASE WHEN D.CUATM_FULL LIKE '%;1111111%' AND D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5_2,
 CIS2.NVAL(MAX(CASE WHEN D.CUATM_FULL LIKE '%;2222222%' AND D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5_3,
 CIS2.NVAL(MAX(CASE WHEN D.CUATM_FULL LIKE '%;3333333%' AND D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5_4,
 CIS2.NVAL(MAX(CASE WHEN D.CUATM_FULL LIKE '%;9600000%' AND D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5_5

  
  FROM 
  CIS2.VW_DATA_ALL D    
  INNER JOIN CIS2.VW_CL_CAEM2 CC ON (D.CAEM2=CC.CODUL AND CC.FULL_CODE LIKE '%'||D.CAEM2||';%')
  INNER JOIN
  CIS2.X_BAZA_SONDAJ BS ON D.CUIIO=BS.CUIIO AND D. ANUL = BS.ANUL

WHERE
  D.PERIOADA IN (:pPERIOADA) AND 
  D.FORM_VERS = :pFORM_VERS     AND   
  D.FORM= :pFORM     AND    
  (:pID_MDTABLE=:pID_MDTABLE) AND
  D.CUATM_FULL LIKE '%'||:pCOD_CUATM||';%' AND
  D.FORM IN (48)  AND
  BS.PERS_IT BETWEEN 50 AND 249    AND(
  D.CAEM2 BETWEEN 'G46000'  AND 'M7320' )
   GROUP BY D.CUIIO
  )  
  GROUP BY NR_ROW, NUME_ROW)
  
   UNION
 
SELECT
  :pPERIOADA AS PERIOADA,
  :pFORM AS FORM,
  :pFORM_VERS AS FORM_VERS,
  :pID_MDTABLE AS ID_MDTABLE,
  :pCOD_CUATM AS COD_CUATM,
         
  '0' AS  NR_SECTIE,
  '0' AS  NUME_SECTIE,
  '0' AS NR_SECTIE1,
  '0' AS NUME_SECTIE1,
  '0' as NR_SECTIE2,
  '0' as NUME_SECTIE2,
  NR_ROW AS NR_ROW,
  12 ORDINE,
  '00000000' AS DECIMAL_POS,
  NUME_ROW AS NUME_ROW,
  COL1,
  COL2,
  COL3,
  COL4,
  COL5,
  COL6
  
  FROM (
  SELECT 
  NR_ROW,  
  NUME_ROW,
  SUM(COL5) AS COL1,
  SUM(COL5_1) AS COL2,
  SUM(COL5_2) AS COL3,
  SUM(COL5_3) AS COL4,
  SUM(COL5_4) AS COL5,
  SUM(COL5_5) AS COL6
FROM
(
SELECT 
  D.CUIIO,
  '12' AS NR_ROW,
  '250 ?i peste salaria?i' AS NUME_ROW,
 
 CIS2.NVAL(MAX(CASE WHEN D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5,
CIS2.NVAL(MAX(CASE WHEN D.CUATM_FULL LIKE '%;0100000%' AND D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5_1,
 CIS2.NVAL(MAX(CASE WHEN D.CUATM_FULL LIKE '%;1111111%' AND D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5_2,
 CIS2.NVAL(MAX(CASE WHEN D.CUATM_FULL LIKE '%;2222222%' AND D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5_3,
 CIS2.NVAL(MAX(CASE WHEN D.CUATM_FULL LIKE '%;3333333%' AND D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5_4,
 CIS2.NVAL(MAX(CASE WHEN D.CUATM_FULL LIKE '%;9600000%' AND D.CAPITOL||'.'||D.RIND IN ('1041.2.1.1','1041.2.1.2', '1042.3.1.1','1042.3.1.2','1042.3.1.3','1046.7.1.1','1046.7.1.2','1046.7.1.3','1047.8.1.1','1047.8.1.2','1047.8.1.3','1047.8.1.4') AND D.COL1=1 
  THEN D.COL1 ELSE NULL END)) AS COL5_5

  
  FROM 
  CIS2.VW_DATA_ALL D    
  INNER JOIN CIS2.VW_CL_CAEM2 CC ON (D.CAEM2=CC.CODUL AND CC.FULL_CODE LIKE '%'||D.CAEM2||';%')
  INNER JOIN
  CIS2.X_BAZA_SONDAJ BS ON D.CUIIO=BS.CUIIO AND D. ANUL = BS.ANUL

WHERE
  D.PERIOADA IN (:pPERIOADA) AND 
  D.FORM_VERS = :pFORM_VERS     AND   
  D.FORM= :pFORM     AND    
  (:pID_MDTABLE=:pID_MDTABLE) AND
  D.CUATM_FULL LIKE '%'||:pCOD_CUATM||';%' AND
  D.FORM IN (48)  AND
  BS.PERS_IT >=250    AND(
  D.CAEM2 BETWEEN 'G46000'  AND 'M7320' )
   GROUP BY D.CUIIO
  )  
  GROUP BY NR_ROW, NUME_ROW)
  