SELECT
   R.CUIIO,
   MAX(R.DENUMIRE) DENUMIRE,
   R.CUATM,
   CASE 
   WHEN RD.RIND IN '611' THEN '511'
   WHEN RD.RIND IN '612' THEN '512'
   WHEN RD.RIND IN '620' THEN '520'
   WHEN RD.RIND IN '631' THEN '531' 
   WHEN RD.RIND IN '632' THEN '532'
   WHEN RD.RIND IN '633' THEN '533'
   WHEN RD.RIND IN '641' THEN '541'
   WHEN RD.RIND IN '642' THEN '542'
   WHEN RD.RIND IN '643' THEN '543'
   WHEN RD.RIND IN '660' THEN '560'
   WHEN RD.RIND IN '670' THEN '570'              
   
   ELSE RD.RIND END  AS NR_ROW,  
   RD.ORDINE AS ORDINE,
   RD.DENUMIRE AS NUME_ROW, 
   D.PACHET,
   CIS2.NVAL(SUM (CASE WHEN D.CAPITOL IN (1186) AND RD.RIND LIKE '%'||D.RIND||'%'  THEN D.COL1 ELSE NULL END)) AS COL1, 
NULL AS COL2 

 FROM
      CIS2.VW_DATA_ALL D 
      INNER JOIN CIS2.RENIM R ON R.CUIIO=D.CUIIO AND R.CUIIO_VERS=D.CUIIO_VERS 
      CROSS JOIN (
      SELECT 

      D.RIND,
      D.DENUMIRE,
      D.RIND_VERS,
      D.ORDINE  
     FROM     CIS2.MD_RIND D
     
     WHERE 
     
     D.CAPITOL  IN (1186)
     AND D.CAPITOL_VERS = 2012 
     AND D.RIND IN ('611','612','620','631','632','633','641','642','643','660','670')  
     AND D.FORM_VERS IN (2011) 
GROUP BY 
      D.RIND,
      D.DENUMIRE,
      D.RIND_VERS,
      D.ORDINE          
      
      ORDER BY 
      D.ORDINE
      
      
      ) RD
      
     
WHERE  
       D.FORM IN (71)             AND  
       D.PERIOADA IN (:pPERIOADA -2 ) AND
       D.FORM = :pFORM AND
       D.FORM_VERS = :pFORM_VERS  AND  
       D.CUATM_FULL LIKE '%'||:pCOD_CUATM||';%' AND
       D.CAPITOL IN (1186) 
           
       AND D.CUIIO = 37720723
         
GROUP BY  
   R.CUIIO,
   R.CUATM,
   RD.RIND,  
   RD.ORDINE,
   RD.DENUMIRE,
   D.PACHET  
  
   ORDER BY
   R.CUIIO,
   RD.ORDINE
   