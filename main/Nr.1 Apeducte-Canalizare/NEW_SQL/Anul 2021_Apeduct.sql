
SELECT 
  D.CODUL,
  D.FULL_CODE,
  D.DENUMIRE,
  D.CUIIO,
  R.IDNO IDNO,
  
 -- D.IDNO,
  D.DENUMIRE_CUIIO,
  D.CFP, 
  D.RIND,
D.CAP1_1_COL1,
D.CAP1_1_COL2,
D.CAP1_1_COL3,
D.CAP1_1_COL4,
D.CAP1_1_COL5,
D.CAP1_1_COL6,
D.CAP1_1_COL7,
D.CAP1_1_COL8,
D.CAP1_1_COL9,
D.CAP1_1_COL10,
D.CAP1_2_COL1,
D.CAP1_2_COL2,
D.CAP1_2_COL3,
D.CAP1_2_COL4,
D.CAP1_2_COL5,
D.CAP1_2_COL6,
D.CAP1_2_COL7,
D.CAP1_2_COL8,
D.CAP1_2_COL9,
D.CAP1_2_COL10,
D.CAP1_2_COL11,
D.CAP1_2_COL12

----------------------------

--D.CAP1_3_COL1,
--D.CAP1_3_COL2,
--D.CAP1_3_COL3,
--D.CAP1_3_COL4,
--D.CAP1_3_COL5,
--D.CAP1_3_COL6,
--D.CAP1_3_COL7,
--D.CAP1_3_COL8,
--D.CAP1_3_COL9,
--D.CAP1_3_COL10,
--D.CAP1_3_COL11
--  

FROM

(

SELECT

  C.CODUL,
  C.FULL_CODE,
  C.DENUMIRE,
  NULL CUIIO,
  NULL IDNO,
  NULL DENUMIRE_CUIIO,
  NULL AS CFP,
  NULL RIND,



NULL CAP1_1_COL1,
NULL CAP1_1_COL2,
NULL CAP1_1_COL3,
NULL CAP1_1_COL4,
NULL CAP1_1_COL5,
NULL CAP1_1_COL6,
NULL CAP1_1_COL7,
NULL CAP1_1_COL8,
NULL CAP1_1_COL9,
NULL CAP1_1_COL10,

NULL CAP1_2_COL1,
NULL CAP1_2_COL2,
NULL CAP1_2_COL3,
NULL CAP1_2_COL4,
NULL CAP1_2_COL5,
NULL CAP1_2_COL6,
NULL CAP1_2_COL7,
NULL CAP1_2_COL8,
NULL CAP1_2_COL9,

NULL CAP1_2_COL10,
NULL CAP1_2_COL11,
NULL CAP1_2_COL12,

NULL CAP1_3_COL1,
NULL CAP1_3_COL2,
NULL CAP1_3_COL3,
NULL CAP1_3_COL4,
NULL CAP1_3_COL5,
NULL CAP1_3_COL6,
NULL CAP1_3_COL7,
NULL CAP1_3_COL8,
NULL CAP1_3_COL9,
NULL CAP1_3_COL10,
NULL CAP1_3_COL11
    

        FROM  CIS2.VW_CL_CUATM C
        
        
            WHERE 
            
            C.PRGS IN ('2')
                
            
            GROUP BY 
              C.CODUL,
  C.FULL_CODE,
  C.DENUMIRE
  
 UNION 
 
 SELECT
  C.CODUL,
  C.FULL_CODE,
  C.DENUMIRE,
  D.CUIIO,
  
  R.IDNO,
  R.DENUMIRE DENUMIRE_CUIIO,
  R.CFP, 
  D.RIND,
  ROUND(SUM(CASE WHEN D.CAPITOL IN (1034) THEN D.COL1 ELSE 0 END),1) AS CAP1_1_COL1,
  ROUND(SUM(CASE WHEN D.CAPITOL IN (1034) THEN D.COL2 ELSE 0 END),1) AS CAP1_1_COL2,
  ROUND(SUM(CASE WHEN D.CAPITOL IN (1034) THEN D.COL3 ELSE 0 END),1) AS CAP1_1_COL3,
  ROUND(SUM(CASE WHEN D.CAPITOL IN (1034) THEN D.COL4 ELSE 0 END),1) AS CAP1_1_COL4,
  ROUND(SUM(CASE WHEN D.CAPITOL IN (1034) THEN D.COL5 ELSE 0 END),1) AS CAP1_1_COL5,
  ROUND(SUM(CASE WHEN D.CAPITOL IN (1034) THEN D.COL6 ELSE 0 END),1) AS CAP1_1_COL6,
  ROUND(SUM(CASE WHEN D.CAPITOL IN (1034) THEN D.COL7 ELSE 0 END),1) AS CAP1_1_COL7,
  ROUND(SUM(CASE WHEN D.CAPITOL IN (1034) THEN D.COL8 ELSE 0 END),1) AS CAP1_1_COL8,
  ROUND(SUM(CASE WHEN D.CAPITOL IN (1034) THEN D.COL9 ELSE 0 END),1) AS CAP1_1_COL9,
  ROUND(SUM(CASE WHEN D.CAPITOL IN (1034) THEN D.COL10 ELSE 0 END),1) AS CAP1_1_COL10,
  
  ROUND(SUM(CASE WHEN D.CAPITOL IN (1035) THEN D.COL1 ELSE 0 END),1) AS CAP1_2_COL1,
  ROUND(SUM(CASE WHEN D.CAPITOL IN (1035) THEN D.COL2 ELSE 0 END),1) AS CAP1_2_COL2,
  ROUND(SUM(CASE WHEN D.CAPITOL IN (1035) THEN D.COL3 ELSE 0 END),1) AS CAP1_2_COL3,
  ROUND(SUM(CASE WHEN D.CAPITOL IN (1035) THEN D.COL4 ELSE 0 END),1) AS CAP1_2_COL4,
  ROUND(SUM(CASE WHEN D.CAPITOL IN (1035) THEN D.COL5 ELSE 0 END),1) AS CAP1_2_COL5,
  ROUND(SUM(CASE WHEN D.CAPITOL IN (1035) THEN D.COL6 ELSE 0 END),1) AS CAP1_2_COL6,
  ROUND(SUM(CASE WHEN D.CAPITOL IN (1035) THEN D.COL7 ELSE 0 END),1) AS CAP1_2_COL7,
  ROUND(SUM(CASE WHEN D.CAPITOL IN (1035) THEN D.COL8 ELSE 0 END),1) AS CAP1_2_COL8,
  ROUND(SUM(CASE WHEN D.CAPITOL IN (1035) THEN D.COL9 ELSE 0 END),1) AS CAP1_2_COL9,
  ROUND(SUM(CASE WHEN D.CAPITOL IN (1035) THEN D.COL10 ELSE 0 END),1) AS CAP1_2_COL10,
  ROUND(SUM(CASE WHEN D.CAPITOL IN (1035) THEN D.COL11 ELSE 0 END),1) AS CAP1_2_COL11,
  ROUND(SUM(CASE WHEN D.CAPITOL IN (1035) THEN D.COL12 ELSE 0 END),1) AS CAP1_2_COL12,
  
  
  ROUND(SUM(CASE WHEN D.CAPITOL IN (1036) THEN D.COL1 ELSE 0 END),1) AS CAP1_3_COL1,
  ROUND(SUM(CASE WHEN D.CAPITOL IN (1036) THEN D.COL2 ELSE 0 END),1) AS CAP1_3_COL2,
  ROUND(SUM(CASE WHEN D.CAPITOL IN (1036) THEN D.COL3 ELSE 0 END),1) AS CAP1_3_COL3,
  ROUND(SUM(CASE WHEN D.CAPITOL IN (1036) THEN D.COL4 ELSE 0 END),1) AS CAP1_3_COL4,
  ROUND(SUM(CASE WHEN D.CAPITOL IN (1036) THEN D.COL5 ELSE 0 END),1) AS CAP1_3_COL5,
  ROUND(SUM(CASE WHEN D.CAPITOL IN (1036) THEN D.COL6 ELSE 0 END),1) AS CAP1_3_COL6,
  ROUND(SUM(CASE WHEN D.CAPITOL IN (1036) THEN D.COL7 ELSE 0 END),1) AS CAP1_3_COL7,
  ROUND(SUM(CASE WHEN D.CAPITOL IN (1036) THEN D.COL8 ELSE 0 END),1) AS CAP1_3_COL8,
  ROUND(SUM(CASE WHEN D.CAPITOL IN (1036) THEN D.COL9 ELSE 0 END),1) AS CAP1_3_COL9,
  ROUND(SUM(CASE WHEN D.CAPITOL IN (1036) THEN D.COL10 ELSE 0 END),1) AS CAP1_3_COL10,
  ROUND(SUM(CASE WHEN D.CAPITOL IN (1036) THEN D.COL11 ELSE 0 END),1) AS CAP1_3_COL11
 
  
FROM CIS2.VW_DATA_ALL D 
--    INNER JOIN 
--    (SELECT D.*    
--    FROM CIS2.VW_DATA_ALL D
--    
--    WHERE 
--    
--D.ID_MD NOT IN (   
--71819,
--70952,
--76102,
--76103) ) ON DD.CUIIO_VERS = D.CUIIO_VERS AND D.CUIIO = D.CUIIO   AND DD.ID_MD = D.ID_MD

     
    
            INNER JOIN CIS2.VW_CL_CUATM C ON C.CODUL = D.CUATM
            INNER JOIN CIS2.RENIM R ON R.CUIIO = D.CUIIO AND R.CUIIO_VERS = D.CUIIO_VERS 
    
    WHERE 
    
    D.PERIOADA IN (:pPERIOADA)
    AND D.FORM IN (:pFORM)    
    AND D.CAPITOL IN (1034,1035,1036)
     AND D.RIND IN ('0000000')
   -- AND D.RIND  IN ('2710002','2710003')

--AND 
--
--D.ID_MD NOT IN (   
--71819,
--70952,
--76102,
--76103) 

    

   
    
GROUP BY 
  C.CODUL,
  C.FULL_CODE,
  C.DENUMIRE,
  D.CUIIO,
  R.DENUMIRE,
  R.CFP,
  D.RIND,
  R.IDNO
  
  ) D  
  
    LEFT JOIN (

SELECT 
    CUIIO,
    IDNO

                    FROM  USER_BANCU.VW_MAX_RENIM_CIS2
) R ON D.CUIIO = R.CUIIO  


WHERE 
1=1
--AND D.DENUMIRE LIKE '%R-UL%'



ORDER BY 
FULL_CODE