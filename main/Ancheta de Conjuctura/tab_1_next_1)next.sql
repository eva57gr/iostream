SELECT
SUM(A.COL1) AS COL1,
SUM(A.COL2) AS COL2,
SUM(A.COL3) AS COL3,
SUM(A.COL4) AS COL4,
SUM(A.COL5) AS COL5,
SUM(A.COL6) AS COL6,
SUM(A.COL7) AS COL7,
SUM(A.COL8) AS COL8,
SUM(A.COL9) AS COL9,
SUM(A.COL10) AS COL10
FROM
(
SELECT
  A.NR_TABLE, 
  A.TABLE_DENUMIRE,
  A.RIND_DENUMIRE,
  TO_CHAR(ROWNUM) AS ORDINE,
  TO_CHAR(ROWNUM) AS RIND,
  A.COL1,
  A.COL2,
  A.COL3,
  A.COL4,
  A.COL5,
  A.COL6,
  A.COL7,
  A.COL8,
  A.COL9,
  A.COL10
FROM
(SELECT
  1 AS NR_TABLE, 'CAEM2' AS TABLE_DENUMIRE,
  'CAEM '|| A.CAEM2 AS RIND_DENUMIRE,
  CC.FULL_CODE AS ORDINE,
  A.CAEM2 AS RIND,
   
  COUNT(DISTINCT CASE WHEN A.RIND IN ('13.1') AND A.COL1 IN (1) AND C.FULL_CODE LIKE '%'||CC.CODUL||';%' THEN A.CUIIO END) AS COL1,
  COUNT(DISTINCT CASE WHEN A.RIND IN ('13.2') AND A.COL1 IN (1) AND C.FULL_CODE LIKE '%'||CC.CODUL||';%' THEN A.CUIIO END) AS COL2,
  COUNT(DISTINCT CASE WHEN A.RIND IN ('13.3') AND A.COL1 IN (1) AND C.FULL_CODE LIKE '%'||CC.CODUL||';%' THEN A.CUIIO END) AS COL3,
  COUNT(DISTINCT CASE WHEN A.RIND IN ('13.4') AND A.COL1 IN (1) AND C.FULL_CODE LIKE '%'||CC.CODUL||';%' THEN A.CUIIO END) AS COL4,
  COUNT(DISTINCT CASE WHEN A.RIND IN ('13.5') AND A.COL1 IN (1) AND C.FULL_CODE LIKE '%'||CC.CODUL||';%' THEN A.CUIIO END) AS COL5,
  COUNT(DISTINCT CASE WHEN A.RIND IN ('13.1') AND A.COL2 IN (1) AND C.FULL_CODE LIKE '%'||CC.CODUL||';%' THEN A.CUIIO END) AS COL6,
  COUNT(DISTINCT CASE WHEN A.RIND IN ('13.2') AND A.COL2 IN (1) AND C.FULL_CODE LIKE '%'||CC.CODUL||';%' THEN A.CUIIO END) AS COL7,
  COUNT(DISTINCT CASE WHEN A.RIND IN ('13.3') AND A.COL2 IN (1) AND C.FULL_CODE LIKE '%'||CC.CODUL||';%' THEN A.CUIIO END) AS COL8,
  COUNT(DISTINCT CASE WHEN A.RIND IN ('13.4') AND A.COL2 IN (1) AND C.FULL_CODE LIKE '%'||CC.CODUL||';%' THEN A.CUIIO END) AS COL9,
  COUNT(DISTINCT CASE WHEN A.RIND IN ('13.5') AND A.COL2 IN (1) AND C.FULL_CODE LIKE '%'||CC.CODUL||';%' THEN A.CUIIO END) AS COL10


FROM
(SELECT
  D.ANUL,
  D.CUIIO,
  D.CUATM,
  D.CAEM2,
  D.CAPITOL,
  D.RIND,
  D.COL1, 
  D.COL2,
  D.COL3,
  D.COL4
FROM 
  CIS2.VW_DATA_ALL D
WHERE
  D.PERIOADA IN (:pPERIOADA) AND
  D.FORM IN (:pFORM) AND 
  D.CAPITOL IN (1197) AND
  D.RIND IN ('13.1','13.2','13.3','13.4','13.5')--AND D.CUIIO=40988116
) A
  
  INNER JOIN CIS2.VW_CL_CAEM2 C ON SUBSTR( C.CODUL,2,4)  = SUBSTR( A.CAEM2,2,4)                  
  INNER JOIN CIS2.VW_CL_CAEM2 CC ON (C.FULL_CODE LIKE '%'||CC.CODUL||';%')
 
WHERE CC.FULL_CODE ='00000;'
AND A.CAEM2 NOT LIKE 'A%' 
 GROUP BY
 CC.FULL_CODE,
 A.CAEM2

 ORDER BY CC.FULL_CODE) A
 ) A 